!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e){var t=0,i=Array.prototype.slice;e.cleanData=function(t){return function(i){var n,s,r;for(r=0;null!=(s=i[r]);r++)try{n=e._data(s,"events"),n&&n.remove&&e(s).triggerHandler("remove")}catch(o){}t(i)}}(e.cleanData),e.widget=function(t,i,n){var s,r,o,a,l={},d=t.split(".")[0];return t=t.split(".")[1],s=d+"-"+t,n||(n=i,i=e.Widget),e.expr[":"][s.toLowerCase()]=function(t){return!!e.data(t,s)},e[d]=e[d]||{},r=e[d][t],o=e[d][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new o(e,t)},e.extend(o,r,{version:n.version,_proto:e.extend({},n),_childConstructors:[]}),a=new i,a.options=e.widget.extend({},a.options),e.each(n,function(t,n){return e.isFunction(n)?void(l[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},s=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,r=this._superApply;return this._super=e,this._superApply=s,t=n.apply(this,arguments),this._super=i,this._superApply=r,t}}()):void(l[t]=n)}),o.prototype=e.widget.extend(a,{widgetEventPrefix:r?a.widgetEventPrefix||t:t},l,{constructor:o,namespace:d,widgetName:t,widgetFullName:s}),r?(e.each(r._childConstructors,function(t,i){var n=i.prototype;e.widget(n.namespace+"."+n.widgetName,o,i._proto)}),delete r._childConstructors):i._childConstructors.push(o),e.widget.bridge(t,o),o},e.widget.extend=function(t){for(var n,s,r=i.call(arguments,1),o=0,a=r.length;o<a;o++)for(n in r[o])s=r[o][n],r[o].hasOwnProperty(n)&&void 0!==s&&(e.isPlainObject(s)?t[n]=e.isPlainObject(t[n])?e.widget.extend({},t[n],s):e.widget.extend({},s):t[n]=s);return t},e.widget.bridge=function(t,n){var s=n.prototype.widgetFullName||t;e.fn[t]=function(r){var o="string"==typeof r,a=i.call(arguments,1),l=this;return o?this.each(function(){var i,n=e.data(this,s);return"instance"===r?(l=n,!1):n?e.isFunction(n[r])&&"_"!==r.charAt(0)?(i=n[r].apply(n,a),i!==n&&void 0!==i?(l=i&&i.jquery?l.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+r+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; attempted to call method '"+r+"'")}):(a.length&&(r=e.widget.extend.apply(null,[r].concat(a))),this.each(function(){var t=e.data(this,s);t?(t.option(r||{}),t._init&&t._init()):e.data(this,s,new n(r,this))})),l}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(i,n){n=e(n||this.defaultElement||this)[0],this.element=e(n),this.uuid=t++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=e(),this.hoverable=e(),this.focusable=e(),n!==this&&(e.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===n&&this.destroy()}}),this.document=e(n.style?n.ownerDocument:n.document||n),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this.options=e.widget.extend({},this.options,this._getCreateOptions(),i),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,i){var n,s,r,o=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(o={},n=t.split("."),t=n.shift(),n.length){for(s=o[t]=e.widget.extend({},this.options[t]),r=0;r<n.length-1;r++)s[n[r]]=s[n[r]]||{},s=s[n[r]];if(t=n.pop(),1===arguments.length)return void 0===s[t]?null:s[t];s[t]=i}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];o[t]=i}return this._setOptions(o),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,i,n){var s,r=this;"boolean"!=typeof t&&(n=i,i=t,t=!1),n?(i=s=e(i),this.bindings=this.bindings.add(i)):(n=i,i=this.element,s=this.widget()),e.each(n,function(n,o){function a(){if(t||r.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled"))return("string"==typeof o?r[o]:o).apply(r,arguments)}"string"!=typeof o&&(a.guid=o.guid=o.guid||a.guid||e.guid++);var l=n.match(/^([\w:-]*)\s*(.*)$/),d=l[1]+r.eventNamespace,u=l[2];u?s.delegate(u,d,a):i.bind(d,a)})},_off:function(t,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(i).undelegate(i),this.bindings=e(this.bindings.not(t).get()),this.focusable=e(this.focusable.not(t).get()),this.hoverable=e(this.hoverable.not(t).get())},_delay:function(e,t){function i(){return("string"==typeof e?n[e]:e).apply(n,arguments)}var n=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,n){var s,r,o=this.options[t];if(n=n||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],r=i.originalEvent)for(s in r)s in i||(i[s]=r[s]);return this.element.trigger(i,n),!(e.isFunction(o)&&o.apply(this.element[0],[i].concat(n))===!1||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(n,s,r){"string"==typeof s&&(s={effect:s});var o,a=s?s===!0||"number"==typeof s?i:s.effect||i:t;s=s||{},"number"==typeof s&&(s={duration:s}),o=!e.isEmptyObject(s),s.complete=r,s.delay&&n.delay(s.delay),o&&e.effects&&e.effects.effect[a]?n[t](s):a!==t&&n[a]?n[a](s.duration,s.easing,r):n.queue(function(i){e(this)[t](),r&&r.call(n[0]),i()})}});e.widget}),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):window.jQuery)}(function(e){"use strict";var t=0,i=e,n="parseJSON";"JSON"in window&&"parse"in JSON&&(i=JSON,n="parse"),e.ajaxTransport("iframe",function(i){if(i.async){var n,s,r,o=i.initialIframeSrc||"javascript:false;";return{send:function(a,l){n=e('<form style="display:none;"></form>'),n.attr("accept-charset",i.formAcceptCharset),r=/\?/.test(i.url)?"&":"?","DELETE"===i.type?(i.url=i.url+r+"_method=DELETE",i.type="POST"):"PUT"===i.type?(i.url=i.url+r+"_method=PUT",i.type="POST"):"PATCH"===i.type&&(i.url=i.url+r+"_method=PATCH",i.type="POST"),t+=1,s=e('<iframe src="'+o+'" name="iframe-transport-'+t+'"></iframe>').bind("load",function(){var t,r=e.isArray(i.paramName)?i.paramName:[i.paramName];s.unbind("load").bind("load",function(){var t;try{if(t=s.contents(),!t.length||!t[0].firstChild)throw new Error}catch(i){t=void 0}l(200,"success",{iframe:t}),e('<iframe src="'+o+'"></iframe>').appendTo(n),window.setTimeout(function(){n.remove()},0)}),n.prop("target",s.prop("name")).prop("action",i.url).prop("method",i.type),i.formData&&e.each(i.formData,function(t,i){e('<input type="hidden"/>').prop("name",i.name).val(i.value).appendTo(n)}),i.fileInput&&i.fileInput.length&&"POST"===i.type&&(t=i.fileInput.clone(),i.fileInput.after(function(e){return t[e]}),i.paramName&&i.fileInput.each(function(t){e(this).prop("name",r[t]||i.paramName)}),n.append(i.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data"),i.fileInput.removeAttr("form")),n.submit(),t&&t.length&&i.fileInput.each(function(i,n){var s=e(t[i]);e(n).prop("name",s.prop("name")).attr("form",s.attr("form")),s.replaceWith(n)})}),n.append(s).appendTo(document.body)},abort:function(){s&&s.unbind("load").prop("src",o),n&&n.remove()}}}}),e.ajaxSetup({converters:{"iframe text":function(t){return t&&e(t[0].body).text()},"iframe json":function(t){return t&&i[n](e(t[0].body).text())},"iframe html":function(t){return t&&e(t[0].body).html()},"iframe xml":function(t){var i=t&&t[0];return i&&e.isXMLDoc(i)?i:e.parseXML(i.XMLDocument&&i.XMLDocument.xml||e(i.body).html())},"iframe script":function(t){return t&&e.globalEval(e(t[0].body).text())}}})}),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery","jquery-ui/ui/widget"],e):"object"==typeof exports?e(require("jquery"),require("./vendor/jquery.ui.widget")):e(window.jQuery)}(function(e){"use strict";function t(t){var i="dragover"===t;return function(n){n.dataTransfer=n.originalEvent&&n.originalEvent.dataTransfer;var s=n.dataTransfer;s&&e.inArray("Files",s.types)!==-1&&this._trigger(t,e.Event(t,{delegatedEvent:n}))!==!1&&(n.preventDefault(),i&&(s.dropEffect="copy"))}}e.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||e('<input type="file">').prop("disabled")),e.support.xhrFileUpload=!(!window.ProgressEvent||!window.FileReader),e.support.xhrFormDataFileUpload=!!window.FormData,e.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),e.widget("blueimp.fileupload",{options:{dropZone:e(document),pasteZone:void 0,fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,limitMultiFileUploadSize:void 0,limitMultiFileUploadSizeOverhead:512,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(t,i){return t=this.messages[t]||t.toString(),i&&e.each(i,function(e,i){t=t.replace("{"+e+"}",i)}),t},formData:function(e){return e.serializeArray()},add:function(t,i){return!t.isDefaultPrevented()&&void((i.autoUpload||i.autoUpload!==!1&&e(this).fileupload("option","autoUpload"))&&i.process().done(function(){i.submit()}))},processData:!1,contentType:!1,cache:!1,timeout:0},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:e.support.blobSlice&&function(){var e=this.slice||this.webkitSlice||this.mozSlice;return e.apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime(),this.loaded=0,this.bitrate=0,this.getBitrate=function(e,t,i){var n=e-this.timestamp;return(!this.bitrate||!i||n>i)&&(this.bitrate=(t-this.loaded)*(1e3/n)*8,this.loaded=t,this.timestamp=e),this.bitrate}},_isXHRUpload:function(t){return!t.forceIframeTransport&&(!t.multipart&&e.support.xhrFileUpload||e.support.xhrFormDataFileUpload)},_getFormData:function(t){var i;return"function"===e.type(t.formData)?t.formData(t.form):e.isArray(t.formData)?t.formData:"object"===e.type(t.formData)?(i=[],e.each(t.formData,function(e,t){i.push({name:e,value:t})}),i):[]},_getTotal:function(t){var i=0;return e.each(t,function(e,t){i+=t.size||1}),i},_initProgressObject:function(t){var i={loaded:0,total:0,bitrate:0};t._progress?e.extend(t._progress,i):t._progress=i},_initResponseObject:function(e){var t;if(e._response)for(t in e._response)e._response.hasOwnProperty(t)&&delete e._response[t];else e._response={}},_onProgress:function(t,i){if(t.lengthComputable){var n,s=Date.now?Date.now():(new Date).getTime();if(i._time&&i.progressInterval&&s-i._time<i.progressInterval&&t.loaded!==t.total)return;i._time=s,n=Math.floor(t.loaded/t.total*(i.chunkSize||i._progress.total))+(i.uploadedBytes||0),this._progress.loaded+=n-i._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(s,this._progress.loaded,i.bitrateInterval),i._progress.loaded=i.loaded=n,i._progress.bitrate=i.bitrate=i._bitrateTimer.getBitrate(s,n,i.bitrateInterval),this._trigger("progress",e.Event("progress",{delegatedEvent:t}),i),this._trigger("progressall",e.Event("progressall",{delegatedEvent:t}),this._progress)}},_initProgressListener:function(t){var i=this,n=t.xhr?t.xhr():e.ajaxSettings.xhr();n.upload&&(e(n.upload).bind("progress",function(e){var n=e.originalEvent;e.lengthComputable=n.lengthComputable,e.loaded=n.loaded,e.total=n.total,i._onProgress(e,t)}),t.xhr=function(){return n})},_isInstanceOf:function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},_initXHRData:function(t){var i,n=this,s=t.files[0],r=t.multipart||!e.support.xhrFileUpload,o="array"===e.type(t.paramName)?t.paramName[0]:t.paramName;t.headers=e.extend({},t.headers),t.contentRange&&(t.headers["Content-Range"]=t.contentRange),r&&!t.blob&&this._isInstanceOf("File",s)||(t.headers["Content-Disposition"]='attachment; filename="'+encodeURI(s.name)+'"'),r?e.support.xhrFormDataFileUpload&&(t.postMessage?(i=this._getFormData(t),t.blob?i.push({name:o,value:t.blob}):e.each(t.files,function(n,s){i.push({name:"array"===e.type(t.paramName)&&t.paramName[n]||o,value:s})})):(n._isInstanceOf("FormData",t.formData)?i=t.formData:(i=new FormData,e.each(this._getFormData(t),function(e,t){i.append(t.name,t.value)})),t.blob?i.append(o,t.blob,s.name):e.each(t.files,function(s,r){(n._isInstanceOf("File",r)||n._isInstanceOf("Blob",r))&&i.append("array"===e.type(t.paramName)&&t.paramName[s]||o,r,r.uploadName||r.name)})),t.data=i):(t.contentType=s.type||"application/octet-stream",t.data=t.blob||s),t.blob=null},_initIframeSettings:function(t){var i=e("<a></a>").prop("href",t.url).prop("host");t.dataType="iframe "+(t.dataType||""),t.formData=this._getFormData(t),t.redirect&&i&&i!==location.host&&t.formData.push({name:t.redirectParamName||"redirect",value:t.redirect})},_initDataSettings:function(e){this._isXHRUpload(e)?(this._chunkedUpload(e,!0)||(e.data||this._initXHRData(e),this._initProgressListener(e)),e.postMessage&&(e.dataType="postmessage "+(e.dataType||""))):this._initIframeSettings(e)},_getParamName:function(t){var i=e(t.fileInput),n=t.paramName;return n?e.isArray(n)||(n=[n]):(n=[],i.each(function(){for(var t=e(this),i=t.prop("name")||"files[]",s=(t.prop("files")||[1]).length;s;)n.push(i),s-=1}),n.length||(n=[i.prop("name")||"files[]"])),n},_initFormSettings:function(t){t.form&&t.form.length||(t.form=e(t.fileInput.prop("form")),t.form.length||(t.form=e(this.options.fileInput.prop("form")))),t.paramName=this._getParamName(t),t.url||(t.url=t.form.prop("action")||location.href),t.type=(t.type||"string"===e.type(t.form.prop("method"))&&t.form.prop("method")||"").toUpperCase(),"POST"!==t.type&&"PUT"!==t.type&&"PATCH"!==t.type&&(t.type="POST"),t.formAcceptCharset||(t.formAcceptCharset=t.form.attr("accept-charset"))},_getAJAXSettings:function(t){var i=e.extend({},this.options,t);return this._initFormSettings(i),this._initDataSettings(i),i},_getDeferredState:function(e){return e.state?e.state():e.isResolved()?"resolved":e.isRejected()?"rejected":"pending"},_enhancePromise:function(e){return e.success=e.done,e.error=e.fail,e.complete=e.always,e},_getXHRPromise:function(t,i,n){var s=e.Deferred(),r=s.promise();return i=i||this.options.context||r,t===!0?s.resolveWith(i,n):t===!1&&s.rejectWith(i,n),r.abort=s.promise,this._enhancePromise(r)},_addConvenienceMethods:function(t,i){var n=this,s=function(t){return e.Deferred().resolveWith(n,t).promise()};i.process=function(t,r){return(t||r)&&(i._processQueue=this._processQueue=(this._processQueue||s([this])).then(function(){return i.errorThrown?e.Deferred().rejectWith(n,[i]).promise():s(arguments)}).then(t,r)),this._processQueue||s([this])},i.submit=function(){return"pending"!==this.state()&&(i.jqXHR=this.jqXHR=n._trigger("submit",e.Event("submit",{delegatedEvent:t}),this)!==!1&&n._onSend(t,this)),this.jqXHR||n._getXHRPromise()},i.abort=function(){return this.jqXHR?this.jqXHR.abort():(this.errorThrown="abort",n._trigger("fail",null,this),n._getXHRPromise(!1))},i.state=function(){return this.jqXHR?n._getDeferredState(this.jqXHR):this._processQueue?n._getDeferredState(this._processQueue):void 0},i.processing=function(){return!this.jqXHR&&this._processQueue&&"pending"===n._getDeferredState(this._processQueue)},i.progress=function(){return this._progress},i.response=function(){return this._response}},_getUploadedBytes:function(e){var t=e.getResponseHeader("Range"),i=t&&t.split("-"),n=i&&i.length>1&&parseInt(i[1],10);return n&&n+1},_chunkedUpload:function(t,i){t.uploadedBytes=t.uploadedBytes||0;var n,s,r=this,o=t.files[0],a=o.size,l=t.uploadedBytes,d=t.maxChunkSize||a,u=this._blobSlice,c=e.Deferred(),p=c.promise();return!(!(this._isXHRUpload(t)&&u&&(l||d<a))||t.data)&&(!!i||(l>=a?(o.error=t.i18n("uploadedBytes"),this._getXHRPromise(!1,t.context,[null,"error",o.error])):(s=function(){var i=e.extend({},t),p=i._progress.loaded;i.blob=u.call(o,l,l+d,o.type),i.chunkSize=i.blob.size,i.contentRange="bytes "+l+"-"+(l+i.chunkSize-1)+"/"+a,r._initXHRData(i),r._initProgressListener(i),n=(r._trigger("chunksend",null,i)!==!1&&e.ajax(i)||r._getXHRPromise(!1,i.context)).done(function(n,o,d){l=r._getUploadedBytes(d)||l+i.chunkSize,p+i.chunkSize-i._progress.loaded&&r._onProgress(e.Event("progress",{lengthComputable:!0,loaded:l-i.uploadedBytes,total:l-i.uploadedBytes}),i),t.uploadedBytes=i.uploadedBytes=l,i.result=n,i.textStatus=o,i.jqXHR=d,r._trigger("chunkdone",null,i),r._trigger("chunkalways",null,i),l<a?s():c.resolveWith(i.context,[n,o,d])}).fail(function(e,t,n){i.jqXHR=e,i.textStatus=t,i.errorThrown=n,r._trigger("chunkfail",null,i),r._trigger("chunkalways",null,i),c.rejectWith(i.context,[e,t,n])})},this._enhancePromise(p),p.abort=function(){return n.abort()},s(),p)))},_beforeSend:function(e,t){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0),this._initResponseObject(t),this._initProgressObject(t),t._progress.loaded=t.loaded=t.uploadedBytes||0,t._progress.total=t.total=this._getTotal(t.files)||1,t._progress.bitrate=t.bitrate=0,this._active+=1,this._progress.loaded+=t.loaded,this._progress.total+=t.total},_onDone:function(t,i,n,s){var r=s._progress.total,o=s._response;s._progress.loaded<r&&this._onProgress(e.Event("progress",{lengthComputable:!0,loaded:r,total:r}),s),o.result=s.result=t,o.textStatus=s.textStatus=i,o.jqXHR=s.jqXHR=n,this._trigger("done",null,s)},_onFail:function(e,t,i,n){var s=n._response;n.recalculateProgress&&(this._progress.loaded-=n._progress.loaded,this._progress.total-=n._progress.total),s.jqXHR=n.jqXHR=e,s.textStatus=n.textStatus=t,s.errorThrown=n.errorThrown=i,this._trigger("fail",null,n)},_onAlways:function(e,t,i,n){this._trigger("always",null,n)},_onSend:function(t,i){i.submit||this._addConvenienceMethods(t,i);var n,s,r,o,a=this,l=a._getAJAXSettings(i),d=function(){return a._sending+=1,l._bitrateTimer=new a._BitrateTimer,n=n||((s||a._trigger("send",e.Event("send",{delegatedEvent:t}),l)===!1)&&a._getXHRPromise(!1,l.context,s)||a._chunkedUpload(l)||e.ajax(l)).done(function(e,t,i){a._onDone(e,t,i,l)}).fail(function(e,t,i){a._onFail(e,t,i,l)}).always(function(e,t,i){if(a._onAlways(e,t,i,l),a._sending-=1,a._active-=1,l.limitConcurrentUploads&&l.limitConcurrentUploads>a._sending)for(var n=a._slots.shift();n;){if("pending"===a._getDeferredState(n)){n.resolve();break}n=a._slots.shift()}0===a._active&&a._trigger("stop")})};return this._beforeSend(t,l),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(r=e.Deferred(),this._slots.push(r),o=r.then(d)):(this._sequence=this._sequence.then(d,d),o=this._sequence),o.abort=function(){return s=[void 0,"abort","abort"],n?n.abort():(r&&r.rejectWith(l.context,s),d())},this._enhancePromise(o)):d()},_onAdd:function(t,i){var n,s,r,o,a=this,l=!0,d=e.extend({},this.options,i),u=i.files,c=u.length,p=d.limitMultiFileUploads,h=d.limitMultiFileUploadSize,f=d.limitMultiFileUploadSizeOverhead,m=0,g=this._getParamName(d),v=0;if(!c)return!1;if(h&&void 0===u[0].size&&(h=void 0),(d.singleFileUploads||p||h)&&this._isXHRUpload(d))if(d.singleFileUploads||h||!p)if(!d.singleFileUploads&&h)for(r=[],n=[],o=0;o<c;o+=1)m+=u[o].size+f,(o+1===c||m+u[o+1].size+f>h||p&&o+1-v>=p)&&(r.push(u.slice(v,o+1)),s=g.slice(v,o+1),s.length||(s=g),n.push(s),v=o+1,m=0);else n=g;else for(r=[],n=[],o=0;o<c;o+=p)r.push(u.slice(o,o+p)),s=g.slice(o,o+p),s.length||(s=g),n.push(s);else r=[u],n=[g];return i.originalFiles=u,e.each(r||u,function(s,o){var d=e.extend({},i);return d.files=r?o:[o],d.paramName=n[s],a._initResponseObject(d),a._initProgressObject(d),a._addConvenienceMethods(t,d),l=a._trigger("add",e.Event("add",{delegatedEvent:t}),d)}),l},_replaceFileInput:function(t){var i=t.fileInput,n=i.clone(!0),s=i.is(document.activeElement);t.fileInputClone=n,e("<form></form>").append(n)[0].reset(),i.after(n).detach(),s&&n.focus(),e.cleanData(i.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(e,t){return t===i[0]?n[0]:t}),i[0]===this.element[0]&&(this.element=n)},_handleFileTreeEntry:function(t,i){var n,s=this,r=e.Deferred(),o=[],a=function(e){e&&!e.entry&&(e.entry=t),r.resolve([e])},l=function(e){s._handleFileTreeEntries(e,i+t.name+"/").done(function(e){r.resolve(e)}).fail(a)},d=function(){n.readEntries(function(e){e.length?(o=o.concat(e),d()):l(o)},a)};return i=i||"",t.isFile?t._file?(t._file.relativePath=i,r.resolve(t._file)):t.file(function(e){e.relativePath=i,r.resolve(e)},a):t.isDirectory?(n=t.createReader(),d()):r.resolve([]),r.promise()},_handleFileTreeEntries:function(t,i){var n=this;return e.when.apply(e,e.map(t,function(e){return n._handleFileTreeEntry(e,i)})).then(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(t){t=t||{};var i=t.items;return i&&i.length&&(i[0].webkitGetAsEntry||i[0].getAsEntry)?this._handleFileTreeEntries(e.map(i,function(e){var t;return e.webkitGetAsEntry?(t=e.webkitGetAsEntry(),t&&(t._file=e.getAsFile()),t):e.getAsEntry()})):e.Deferred().resolve(e.makeArray(t.files)).promise()},_getSingleFileInputFiles:function(t){t=e(t);var i,n,s=t.prop("webkitEntries")||t.prop("entries");if(s&&s.length)return this._handleFileTreeEntries(s);if(i=e.makeArray(t.prop("files")),i.length)void 0===i[0].name&&i[0].fileName&&e.each(i,function(e,t){t.name=t.fileName,t.size=t.fileSize});else{if(n=t.prop("value"),!n)return e.Deferred().resolve([]).promise();i=[{name:n.replace(/^.*\\/,"")}]}return e.Deferred().resolve(i).promise()},_getFileInputFiles:function(t){return t instanceof e&&1!==t.length?e.when.apply(e,e.map(t,this._getSingleFileInputFiles)).then(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(t)},_onChange:function(t){var i=this,n={fileInput:e(t.target),form:e(t.target.form)};this._getFileInputFiles(n.fileInput).always(function(s){n.files=s,i.options.replaceFileInput&&i._replaceFileInput(n),i._trigger("change",e.Event("change",{delegatedEvent:t}),n)!==!1&&i._onAdd(t,n)})},_onPaste:function(t){var i=t.originalEvent&&t.originalEvent.clipboardData&&t.originalEvent.clipboardData.items,n={files:[]};i&&i.length&&(e.each(i,function(e,t){var i=t.getAsFile&&t.getAsFile();i&&n.files.push(i)}),this._trigger("paste",e.Event("paste",{delegatedEvent:t}),n)!==!1&&this._onAdd(t,n))},_onDrop:function(t){t.dataTransfer=t.originalEvent&&t.originalEvent.dataTransfer;var i=this,n=t.dataTransfer,s={};n&&n.files&&n.files.length&&(t.preventDefault(),this._getDroppedFiles(n).always(function(n){s.files=n,i._trigger("drop",e.Event("drop",{delegatedEvent:t}),s)!==!1&&i._onAdd(t,s)}))},_onDragOver:t("dragover"),_onDragEnter:t("dragenter"),_onDragLeave:t("dragleave"),_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop,dragenter:this._onDragEnter,dragleave:this._onDragLeave}),this._on(this.options.pasteZone,{paste:this._onPaste})),e.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragenter dragleave dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_destroy:function(){this._destroyEventHandlers()},_setOption:function(t,i){var n=e.inArray(t,this._specialOptions)!==-1;n&&this._destroyEventHandlers(),this._super(t,i),n&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var t=this.options;void 0===t.fileInput?t.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):t.fileInput instanceof e||(t.fileInput=e(t.fileInput)),t.dropZone instanceof e||(t.dropZone=e(t.dropZone)),t.pasteZone instanceof e||(t.pasteZone=e(t.pasteZone))},_getRegExp:function(e){var t=e.split("/"),i=t.pop();return t.shift(),new RegExp(t.join("/"),i)},_isRegExpOption:function(t,i){return"url"!==t&&"string"===e.type(i)&&/^\/.*\/[igm]{0,3}$/.test(i)},_initDataAttributes:function(){var t=this,i=this.options,n=this.element.data();e.each(this.element[0].attributes,function(e,s){var r,o=s.name.toLowerCase();/^data-/.test(o)&&(o=o.slice(5).replace(/-[a-z]/g,function(e){return e.charAt(1).toUpperCase()}),r=n[o],t._isRegExpOption(o,r)&&(r=t._getRegExp(r)),i[o]=r)})},_create:function(){this._initDataAttributes(),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=0,this._initProgressObject(this),this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(t){var i=this;t&&!this.options.disabled&&(t.fileInput&&!t.files?this._getFileInputFiles(t.fileInput).always(function(e){t.files=e,i._onAdd(null,t)}):(t.files=e.makeArray(t.files),this._onAdd(null,t)))},send:function(t){if(t&&!this.options.disabled){if(t.fileInput&&!t.files){var i,n,s=this,r=e.Deferred(),o=r.promise();return o.abort=function(){return n=!0,i?i.abort():(r.reject(null,"abort","abort"),o)},this._getFileInputFiles(t.fileInput).always(function(e){if(!n){if(!e.length)return void r.reject();t.files=e,i=s._onSend(null,t),i.then(function(e,t,i){r.resolve(e,t,i)},function(e,t,i){r.reject(e,t,i)})}}),this._enhancePromise(o)}if(t.files=e.makeArray(t.files),t.files.length)return this._onSend(null,t)}return this._getXHRPromise(!1,t&&t.context)}})}),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports&&"function"==typeof require?require("jquery"):jQuery)}(function(e){"use strict";function t(i,n){var s=function(){},r=this,o={ajaxSettings:{},autoSelectFirst:!1,appendTo:document.body,serviceUrl:null,lookup:null,onSelect:null,width:"auto",minChars:1,maxHeight:300,deferRequestBy:0,params:{},formatResult:t.formatResult,delimiter:null,zIndex:9999,type:"GET",noCache:!1,onSearchStart:s,onSearchComplete:s,onSearchError:s,preserveInput:!1,containerClass:"autocomplete-suggestions",tabDisabled:!1,dataType:"text",currentRequest:null,triggerSelectOnValidInput:!0,preventBadQueries:!0,lookupFilter:function(e,t,i){return e.value.toLowerCase().indexOf(i)!==-1},paramName:"query",transformResult:function(t){return"string"==typeof t?e.parseJSON(t):t},showNoSuggestionNotice:!1,noSuggestionNotice:"No results",orientation:"bottom",forceFixPosition:!1};r.element=i,r.el=e(i),r.suggestions=[],r.badQueries=[],r.selectedIndex=-1,r.currentValue=r.element.value,r.intervalId=0,r.cachedResponse={},r.onChangeInterval=null,r.onChange=null,r.isLocal=!1,r.suggestionsContainer=null,r.noSuggestionsContainer=null,r.options=e.extend({},o,n),r.classes={selected:"autocomplete-selected",suggestion:"autocomplete-suggestion"},r.hint=null,r.hintValue="",r.selection=null,r.initialize(),r.setOptions(n)}var i=function(){return{escapeRegExChars:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},createNode:function(e){var t=document.createElement("div");return t.className=e,t.style.position="absolute",t.style.display="none",t}}}(),n={ESC:27,TAB:9,RETURN:13,LEFT:37,UP:38,RIGHT:39,DOWN:40};t.utils=i,e.Autocomplete=t,t.formatResult=function(e,t){var n="("+i.escapeRegExChars(t)+")";return e.value.replace(new RegExp(n,"gi"),"<strong>$1</strong>").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/&lt;(\/?strong)&gt;/g,"<$1>")},t.prototype={killerFn:null,initialize:function(){var i,n=this,s="."+n.classes.suggestion,r=n.classes.selected,o=n.options;n.element.setAttribute("autocomplete","off"),n.killerFn=function(t){0===e(t.target).closest("."+n.options.containerClass).length&&(n.killSuggestions(),n.disableKillerFn())},n.noSuggestionsContainer=e('<div class="autocomplete-no-suggestion"></div>').html(this.options.noSuggestionNotice).get(0),n.suggestionsContainer=t.utils.createNode(o.containerClass),i=e(n.suggestionsContainer),i.appendTo(o.appendTo),"auto"!==o.width&&i.width(o.width),i.on("mouseover.autocomplete",s,function(){n.activate(e(this).data("index"))}),i.on("mouseout.autocomplete",function(){n.selectedIndex=-1,i.children("."+r).removeClass(r)}),i.on("click.autocomplete",s,function(){n.select(e(this).data("index"))}),n.fixPositionCapture=function(){n.visible&&n.fixPosition()},e(window).on("resize.autocomplete",n.fixPositionCapture),n.el.on("keydown.autocomplete",function(e){n.onKeyPress(e)}),n.el.on("keyup.autocomplete",function(e){n.onKeyUp(e)}),n.el.on("blur.autocomplete",function(){n.onBlur()}),n.el.on("focus.autocomplete",function(){n.onFocus()}),n.el.on("change.autocomplete",function(e){n.onKeyUp(e)}),n.el.on("input.autocomplete",function(e){n.onKeyUp(e)})},onFocus:function(){var e=this;e.fixPosition(),0===e.options.minChars&&0===e.el.val().length&&e.onValueChange()},onBlur:function(){this.enableKillerFn()},abortAjax:function(){var e=this;e.currentRequest&&(e.currentRequest.abort(),e.currentRequest=null)},setOptions:function(t){var i=this,n=i.options;e.extend(n,t),i.isLocal=e.isArray(n.lookup),i.isLocal&&(n.lookup=i.verifySuggestionsFormat(n.lookup)),n.orientation=i.validateOrientation(n.orientation,"bottom"),e(i.suggestionsContainer).css({"max-height":n.maxHeight+"px",width:n.width+"px","z-index":n.zIndex})},clearCache:function(){this.cachedResponse={},this.badQueries=[]},clear:function(){this.clearCache(),this.currentValue="",this.suggestions=[]},disable:function(){var e=this;e.disabled=!0,clearInterval(e.onChangeInterval),e.abortAjax()},enable:function(){this.disabled=!1},fixPosition:function(){var t=this,i=e(t.suggestionsContainer),n=i.parent().get(0);if(n===document.body||t.options.forceFixPosition){var s=t.options.orientation,r=i.outerHeight(),o=t.el.outerHeight(),a=t.el.offset(),l={top:a.top,left:a.left};if("auto"===s){var d=e(window).height(),u=e(window).scrollTop(),c=-u+a.top-r,p=u+d-(a.top+o+r);s=Math.max(c,p)===c?"top":"bottom"}if("top"===s?l.top+=-r:l.top+=o,n!==document.body){var h,f=i.css("opacity");t.visible||i.css("opacity",0).show(),h=i.offsetParent().offset(),l.top-=h.top,l.left-=h.left,t.visible||i.css("opacity",f).hide()}"auto"===t.options.width&&(l.width=t.el.outerWidth()-2+"px"),i.css(l)}},enableKillerFn:function(){var t=this;e(document).on("click.autocomplete",t.killerFn)},disableKillerFn:function(){var t=this;e(document).off("click.autocomplete",t.killerFn)},killSuggestions:function(){var e=this;
e.stopKillSuggestions(),e.intervalId=window.setInterval(function(){e.visible&&(e.el.val(e.currentValue),e.hide()),e.stopKillSuggestions()},50)},stopKillSuggestions:function(){window.clearInterval(this.intervalId)},isCursorAtEnd:function(){var e,t=this,i=t.el.val().length,n=t.element.selectionStart;return"number"==typeof n?n===i:!document.selection||(e=document.selection.createRange(),e.moveStart("character",-i),i===e.text.length)},onKeyPress:function(e){var t=this;if(!t.disabled&&!t.visible&&e.which===n.DOWN&&t.currentValue)return void t.suggest();if(!t.disabled&&t.visible){switch(e.which){case n.ESC:t.el.val(t.currentValue),t.hide();break;case n.RIGHT:if(t.hint&&t.options.onHint&&t.isCursorAtEnd()){t.selectHint();break}return;case n.TAB:if(t.hint&&t.options.onHint)return void t.selectHint();if(t.selectedIndex===-1)return void t.hide();if(t.select(t.selectedIndex),t.options.tabDisabled===!1)return;break;case n.RETURN:if(t.selectedIndex===-1)return void t.hide();t.select(t.selectedIndex);break;case n.UP:t.moveUp();break;case n.DOWN:t.moveDown();break;default:return}e.stopImmediatePropagation(),e.preventDefault()}},onKeyUp:function(e){var t=this;if(!t.disabled){switch(e.which){case n.UP:case n.DOWN:return}clearInterval(t.onChangeInterval),t.currentValue!==t.el.val()&&(t.findBestHint(),t.options.deferRequestBy>0?t.onChangeInterval=setInterval(function(){t.onValueChange()},t.options.deferRequestBy):t.onValueChange())}},onValueChange:function(){var t=this,i=t.options,n=t.el.val(),s=t.getQuery(n);return t.selection&&t.currentValue!==s&&(t.selection=null,(i.onInvalidateSelection||e.noop).call(t.element)),clearInterval(t.onChangeInterval),t.currentValue=n,t.selectedIndex=-1,i.triggerSelectOnValidInput&&t.isExactMatch(s)?void t.select(0):void(s.length<i.minChars?t.hide():t.getSuggestions(s))},isExactMatch:function(e){var t=this.suggestions;return 1===t.length&&t[0].value.toLowerCase()===e.toLowerCase()},getQuery:function(t){var i,n=this.options.delimiter;return n?(i=t.split(n),e.trim(i[i.length-1])):t},getSuggestionsLocal:function(t){var i,n=this,s=n.options,r=t.toLowerCase(),o=s.lookupFilter,a=parseInt(s.lookupLimit,10);return i={suggestions:e.grep(s.lookup,function(e){return o(e,t,r)})},a&&i.suggestions.length>a&&(i.suggestions=i.suggestions.slice(0,a)),i},getSuggestions:function(t){var i,n,s,r,o=this,a=o.options,l=a.serviceUrl;if(a.params[a.paramName]=t,n=a.ignoreParams?null:a.params,a.onSearchStart.call(o.element,a.params)!==!1){if(e.isFunction(a.lookup))return void a.lookup(t,function(e){o.suggestions=e.suggestions,o.suggest(),a.onSearchComplete.call(o.element,t,e.suggestions)});o.isLocal?i=o.getSuggestionsLocal(t):(e.isFunction(l)&&(l=l.call(o.element,t)),s=l+"?"+e.param(n||{}),i=o.cachedResponse[s]),i&&e.isArray(i.suggestions)?(o.suggestions=i.suggestions,o.suggest(),a.onSearchComplete.call(o.element,t,i.suggestions)):o.isBadQuery(t)?a.onSearchComplete.call(o.element,t,[]):(o.abortAjax(),r={url:l,data:n,type:a.type,dataType:a.dataType},e.extend(r,a.ajaxSettings),o.currentRequest=e.ajax(r).done(function(e){var i;o.currentRequest=null,i=a.transformResult(e,t),o.processResponse(i,t,s),a.onSearchComplete.call(o.element,t,i.suggestions)}).fail(function(e,i,n){a.onSearchError.call(o.element,t,e,i,n)}))}},isBadQuery:function(e){if(!this.options.preventBadQueries)return!1;for(var t=this.badQueries,i=t.length;i--;)if(0===e.indexOf(t[i]))return!0;return!1},hide:function(){var t=this,i=e(t.suggestionsContainer);e.isFunction(t.options.onHide)&&t.visible&&t.options.onHide.call(t.element,i),t.visible=!1,t.selectedIndex=-1,clearInterval(t.onChangeInterval),e(t.suggestionsContainer).hide(),t.signalHint(null)},suggest:function(){if(0===this.suggestions.length)return void(this.options.showNoSuggestionNotice?this.noSuggestions():this.hide());var t,i=this,n=i.options,s=n.groupBy,r=n.formatResult,o=i.getQuery(i.currentValue),a=i.classes.suggestion,l=i.classes.selected,d=e(i.suggestionsContainer),u=e(i.noSuggestionsContainer),c=n.beforeRender,p="",h=function(e,i){var n=e.data[s];return t===n?"":(t=n,'<div class="autocomplete-group"><strong>'+t+"</strong></div>")};return n.triggerSelectOnValidInput&&i.isExactMatch(o)?void i.select(0):(e.each(i.suggestions,function(e,t){s&&(p+=h(t,o,e)),p+='<div class="'+a+'" data-index="'+e+'">'+r(t,o)+"</div>"}),this.adjustContainerWidth(),u.detach(),d.html(p),e.isFunction(c)&&c.call(i.element,d),i.fixPosition(),d.show(),n.autoSelectFirst&&(i.selectedIndex=0,d.scrollTop(0),d.children("."+a).first().addClass(l)),i.visible=!0,void i.findBestHint())},noSuggestions:function(){var t=this,i=e(t.suggestionsContainer),n=e(t.noSuggestionsContainer);this.adjustContainerWidth(),n.detach(),i.empty(),i.append(n),t.fixPosition(),i.show(),t.visible=!0},adjustContainerWidth:function(){var t,i=this,n=i.options,s=e(i.suggestionsContainer);"auto"===n.width&&(t=i.el.outerWidth()-2,s.width(t>0?t:300))},findBestHint:function(){var t=this,i=t.el.val().toLowerCase(),n=null;i&&(e.each(t.suggestions,function(e,t){var s=0===t.value.toLowerCase().indexOf(i);return s&&(n=t),!s}),t.signalHint(n))},signalHint:function(t){var i="",n=this;t&&(i=n.currentValue+t.value.substr(n.currentValue.length)),n.hintValue!==i&&(n.hintValue=i,n.hint=t,(this.options.onHint||e.noop)(i))},verifySuggestionsFormat:function(t){return t.length&&"string"==typeof t[0]?e.map(t,function(e){return{value:e,data:null}}):t},validateOrientation:function(t,i){return t=e.trim(t||"").toLowerCase(),e.inArray(t,["auto","bottom","top"])===-1&&(t=i),t},processResponse:function(e,t,i){var n=this,s=n.options;e.suggestions=n.verifySuggestionsFormat(e.suggestions),s.noCache||(n.cachedResponse[i]=e,s.preventBadQueries&&0===e.suggestions.length&&n.badQueries.push(t)),t===n.getQuery(n.currentValue)&&(n.suggestions=e.suggestions,n.suggest())},activate:function(t){var i,n=this,s=n.classes.selected,r=e(n.suggestionsContainer),o=r.find("."+n.classes.suggestion);return r.find("."+s).removeClass(s),n.selectedIndex=t,n.selectedIndex!==-1&&o.length>n.selectedIndex?(i=o.get(n.selectedIndex),e(i).addClass(s),i):null},selectHint:function(){var t=this,i=e.inArray(t.hint,t.suggestions);t.select(i)},select:function(e){var t=this;t.hide(),t.onSelect(e)},moveUp:function(){var t=this;if(t.selectedIndex!==-1)return 0===t.selectedIndex?(e(t.suggestionsContainer).children().first().removeClass(t.classes.selected),t.selectedIndex=-1,t.el.val(t.currentValue),void t.findBestHint()):void t.adjustScroll(t.selectedIndex-1)},moveDown:function(){var e=this;e.selectedIndex!==e.suggestions.length-1&&e.adjustScroll(e.selectedIndex+1)},adjustScroll:function(t){var i=this,n=i.activate(t);if(n){var s,r,o,a=e(n).outerHeight();s=n.offsetTop,r=e(i.suggestionsContainer).scrollTop(),o=r+i.options.maxHeight-a,s<r?e(i.suggestionsContainer).scrollTop(s):s>o&&e(i.suggestionsContainer).scrollTop(s-i.options.maxHeight+a),i.options.preserveInput||i.el.val(i.getValue(i.suggestions[t].value)),i.signalHint(null)}},onSelect:function(t){var i=this,n=i.options.onSelect,s=i.suggestions[t];i.currentValue=i.getValue(s.value),i.currentValue===i.el.val()||i.options.preserveInput||i.el.val(i.currentValue),i.signalHint(null),i.suggestions=[],i.selection=s,e.isFunction(n)&&n.call(i.element,s)},getValue:function(e){var t,i,n=this,s=n.options.delimiter;return s?(t=n.currentValue,i=t.split(s),1===i.length?e:t.substr(0,t.length-i[i.length-1].length)+e):e},dispose:function(){var t=this;t.el.off(".autocomplete").removeData("autocomplete"),t.disableKillerFn(),e(window).off("resize.autocomplete",t.fixPositionCapture),e(t.suggestionsContainer).remove()}},e.fn.autocomplete=e.fn.devbridgeAutocomplete=function(i,n){var s="autocomplete";return 0===arguments.length?this.first().data(s):this.each(function(){var r=e(this),o=r.data(s);"string"==typeof i?o&&"function"==typeof o[i]&&o[i](n):(o&&o.dispose&&o.dispose(),o=new t(this,i),r.data(s,o))})}});var hasProp={}.hasOwnProperty;!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e){var t,i,n,s;e.fn.check=function(){return this.each(function(){return e(this).prop("indeterminate",!1).prop("checked",!0)})},e.fn.uncheck=function(){return this.each(function(){return e(this).prop("indeterminate",!1).prop("checked",!1)})},e.fn.semicheck=function(){return this.each(function(){return e(this).prop("indeterminate",!0).prop("checked",!1)})},e.fn.togglecheck=function(){return this.each(function(){var t;return t=e(this),t.prop("checked",!t.prop("checked"))})},n={data:[],ajax:!1,url:"./",requestSettings:{},responseHandler:function(e){return e},animationSpeed:400,hideFiles:!1,fileNodeName:"name",folderNodeName:"name",fileNodeTitle:"name",folderNodeTitle:"name",nodeTitle:"name",nodeFormatter:function(e){return e},columnView:!1,dblclickDelay:200,classes:{arrow:"glyphicon glyphicon-chevron-right"},searchInput:null,checkboxes:!1,hierarchialCheck:!0},t=function(){function t(t,i){this.element=t,this.settings=e.extend({},n,i),this._defaults=n,this._clicks=0,this._timer=null,this._itemId=0,this._lookup={},this.settings.checkboxes=!this.settings.columnView&&void 0,this._init()}return t.prototype.open=function(t){var i;return i=e(t).closest("li"),!!i.hasClass("folder")&&(this._openFolder(i),this)},t.prototype.close=function(t){var i;return i=e(t).closest("li"),!!i.hasClass("folder")&&(this._closeFolder(i),this)},t.prototype.toggle=function(t){var i;return this.settings.columnView||(i=e(t).closest("li"),i.hasClass("is-collapsed")?this._openFolder(i):i.hasClass("is-expanded")&&this._closeFolder(i)),this},t.prototype.select=function(t){return this._selectItem(e(t).closest("li")),this.settings.checkboxes&&e(t).siblings("input[type=checkbox]").togglecheck().change(),this},t.prototype.getSelectedNodes=function(){return this.settings.checkboxes&&e(this.element).find("input[type=checkbox]:checked").map(function(t,i){return e(i).siblings("a")}).get(),!1},t.prototype.getActivePath=function(){var t;return t=this.settings.columnView?e(this.element).children().find("> .columns:not(.empty):last-child").find(".active > a"):e(this.element).find(".active > a"),t.length?t.data("__path"):"/"},t.prototype.expandTo=function(t){var i,n,s,r,o,a,l,d;if(t=t.replace(/^\/|\/$/g,"").split("/"),i=e(this.element),this.settings.columnView)for(i=i.find("> .list-group-wrapper"),r=o=0,l=t.length;o<l;r=++o){if(n=t[r],s=i.find("> .columns").eq(r).find("> ul.list-group > li > a").filter(function(){return e(this).text()===n}),s.length<1)throw new Error("The folder/file "+n+" does not exists");s=s.eq(0),this.open(s),r===t.length-1&&(this.select(s),e(s).click())}else for(this.collapseAll(!0),r=a=0,d=t.length;a<d;r=++a){if(n=t[r],i=i.find("> ul.list-group > li").filter(function(){return e(this).find("> a").text()===n}),i.length<1)throw new Error("The folder/file "+n+" does not exists");this._openFolder(i),this._selectItem(i),r===t.length-1&&i.find("> a").click()}return this},t.prototype.expandGivenPath=function(t){var i,n,s,r,o,a,l,d;if(t=t.replace(/^[\/\\]|[\/\\]$/g,"").split(/\/|\\/),i=e(this.element),this.settings.columnView)for(i=i.find("> .list-group-wrapper"),r=o=0,l=t.length;o<l;r=++o){if(n=t[r],s=i.find("> .columns").eq(r).find("> ul.list-group > li > a").filter(function(){return e(this).data("path").split(/\/|\\/).pop()===n}),s.length<1)throw new Error("The folder/file "+n+" does not exists");s=s.eq(0),this.open(s),r===t.length-1&&(this.select(s),e(s).click())}else for(this.collapseAll(!0),r=a=0,d=t.length;a<d;r=++a){if(n=t[r],i=i.find("> ul.list-group > li").filter(function(){return e(this).find("> a").data("path")===n}),i.length<1)throw new Error("The folder/file "+n+" does not exists");this._openFolder(i),this._selectItem(i),r===t.length-1&&i.find("> a").click()}return this},t.prototype.expandAll=function(t){var i;return this.settings.columnView||(i=this,t&&(this.settings._animationSpeed=this.settings.animationSpeed,this.settings.animationSpeed=0),e(this.element).find("li.folder.is-collapsed > a").each(function(e,t){return i.open(t)}),t&&(this.settings.animationSpeed=this.settings._animationSpeed,delete this.settings._animationSpeed)),this},t.prototype.collapseAll=function(t){var i;return i=this,this.settings.columnView?e(this.element).find(".list-group-wrapper > .columns:not(:first-child)").remove().end().find(".active").removeClass("active"):(t&&(this.settings._animationSpeed=this.settings.animationSpeed,this.settings.animationSpeed=0),e(this.element).find("li.folder.is-expanded > a").each(function(e,t){return i.close(t)}),t&&(this.settings.animationSpeed=this.settings._animationSpeed,delete this.settings._animationSpeed)),this},t.prototype.destroy=function(){return e(this.element).data("$.filetree",null),e(this.element).off().empty(),this},t.prototype._init=function(){var t,i,n,s,r;return r=this,t=e(this.element).addClass("file-tree"),i=e(document.createElement("span")).insertAfter(e(this.element)),e(this.element).detach(),this.settings.columnView&&(t.addClass("file-tree-columns"),t=e(document.createElement("div")).addClass("list-group-wrapper").appendTo(t)),n=this.settings.data,s=this,this.settings.ajax?e.ajax(this.settings.url,this.settings.requestSettings).then(function(i){return i=s.settings.responseHandler(i),e.isArray(i)&&i.length>0?s._createTree.call(s,t,i):s._showEmpty.call(s,t)}):e.isArray(n)&&n.length>0?this._createTree.call(this,t,n):this._showEmpty(t),this._addListeners(),e(this.element).insertBefore(i),i.remove(),n=null,this.element},t.prototype._createTree=function(t,i,n){var s,r,o,a,l,d,u,c,p,h,f,m,g,v,b,y,_,w,x,C,S;for(null==n&&(n="/"),s=e(t),r=[],o=[],m=0,b=i.length;m<b;m++)h=i[m],"folder"===h.type&&o.push(h),"file"===h.type&&r.push(h);for(r.sort(this._nameSort.bind(this)),o.sort(this._nameSort.bind(this)),i=o.concat(r),C=e(document.createElement("ul")).addClass("list-group"),g=0,y=i.length;g<y;g++)if(f=i[g],"file"!==f.type||this.settings.hideFiles!==!0){_=e(document.createElement("li")).addClass(f.type+" list-group-item"),l=e(document.createElement("a")).attr("href","#").data("__itemId",++this._itemId),["file","folder"].indexOf(f.type)>-1?(x=f[this.settings[f.type+"NodeTitle"]],w=f[this.settings[f.type+"NodeName"]],p=n+f[this.settings[f.type+"NodeName"]]):(x=w=f.name,p=n+f.name),l.html(w).data("__path",p),this._lookup[this._itemId+":"+w]=l;for(v in f)hasProp.call(f,v)&&(S=f[v],"children"!==v&&l.data(v,S));this.settings.columnView&&"folder"===f.type&&(d=e(document.createElement("span")).addClass("arrow "+this.settings.classes.arrow),l.append(d)),_.append(l),this.settings.multiselect&&(u=e(document.createElement("input")).attr("type","checkbox"),f.readOnly&&(u.prop("disabled",!0),_.addClass("is-read-only")),_.prepend(u)),"folder"===f.type&&(_.addClass("is-collapsed"),("undefined"===f.children||f.children.length<1)&&_.addClass("is-empty"),this.settings.columnView||(d=e(document.createElement("button")).addClass("arrow "+this.settings.classes.arrow),_.prepend(d)),this.settings.hideFiles&&(a=e.grep(f.children,function(e){return"folder"===e.type}),a.length>0&&_.removeClass("is-collapsed").addClass("is-empty")),e.isArray(f.children)&&this._createTree.call(this,_,f.children,p+"/")),_=this.settings.nodeFormatter.call(null,_),C.append(_)}return this.settings.columnView?(c=e(document.createElement("div")).addClass("columns"),c.append(C),s.append(c)):s.append(C)},t.prototype._openFolder=function(t){var i,n,s,r,o,a,l,d,u,c;return!t.hasClass("disabled")&&(i=t.find("> a"),r=e(this.element),n=this.settings.columnView?t.find("> .columns"):t.find("> ul"),u=this,l=e.Event("folder.open.filetree"),a=e.Event("folder.opened.filetree"),r.trigger(l),void(this.settings.columnView?(c=r.find(".list-group-wrapper").eq(0),s=t.closest(".columns"),d=s.position().left+s.outerWidth()+c.scrollLeft(),this._selectItem(t),n.find("> ul > li").length>0?(o=n.clone(!0),o.find("> ul").data("_parent",i),o.css("left",d+"px"),o.appendTo(c)):this._showEmpty(c).css("left",d+"px").data("_parent",i),c.scrollLeft(d),r.trigger(a)):n.slideDown(u.settings.animationSpeed,function(){return t.removeClass("is-collapsed").addClass("is-expanded"),n.removeAttr("style"),r.trigger(a)})))},t.prototype._closeFolder=function(t){var i,n,s,r,o,a;i=t.find("> a"),n=this.settings.columnView?t.closest(".columns"):t.find("> ul"),a=this,s=e(this.element),o=e.Event("folder.close.filetree"),r=e.Event("folder.closed.filetree"),s.trigger(o),this.settings.columnView?(n.nextAll(".columns").remove(),s.trigger(r)):n.slideUp(a.settings.animationSpeed,function(){t.removeClass("is-expanded").addClass("is-collapsed"),n.removeAttr("style"),s.trigger(r)})},t.prototype._showEmpty=function(t){var i;return i=e(document.createElement("div")).addClass("columns empty").html("<p>empty folder</p>"),i.appendTo(t)},t.prototype._selectItem=function(t){var i,n,s,r;return!t.hasClass("disabled")&&(i=this.settings.columnView?t.closest(".columns"):e(this.element),i.find("li.active").removeClass("active"),this.settings.columnView&&(this._closeFolder(t),n=t.closest("ul"),s=t.position(),(s.top>n.height()||s.top<0)&&(r=n.scrollTop()+s.top,n.scrollTop(r))),void t.addClass("active"))},t.prototype._triggerClickEvent=function(t){var i,n,s,r,o;n=e(this.element),o=this,this._clicks++,i=e(t.target),r=i.closest("li").hasClass("folder")?"folder":"file",s=i.data(),1===this._clicks?this._timer=setTimeout(function(){o._clicks=0,i.trigger(r+".click.filetree",s)},o.settings.dblclickDelay):(clearTimeout(this._timer),i.trigger(r+".dblclick.filetree",s),this._clicks=0),t.preventDefault()},t.prototype._addListeners=function(){var t,i;t=e(this.element),i=this,t.on("click","li.folder > a, li.file > a",this._triggerClickEvent.bind(this)),this.settings.columnView||t.on("click","li.folder.is-collapsed > button.arrow",function(t){i._openFolder(e(t.target).closest("li")),t.stopImmediatePropagation()}).on("click","li.folder.is-expanded > button.arrow",function(t){i._closeFolder(e(t.target).closest("li")),t.stopImmediatePropagation()}),this.settings.multiselect&&this.settings.hierarchialCheck&&t.on("change","input[type=checkbox]:not([disabled])",function(i){var n,s;n=e(i.target).closest("li"),n.hasClass("folder")&&!n.hasClass("is-empty")&&(s=n.find("> input[type=checkbox]:not([disabled])").prop("checked"),n.find("> ul").find("input[type=checkbox]:not([disabled])").prop("checked",s).prop("indeterminate",!1)),n.parentsUntil(t,"li.folder").each(function(){var t,i,n,s;return t=e(this),n=t.find("> ul").find("input[type=checkbox]:not([disabled])"),s=t.find("> input[type=checkbox]:not([disabled])"),i=t.find("> ul").find("input[type=checkbox]:not([disabled]):checked"),i.length>0?(s.semicheck(),i.length===n.length?s.check():void 0):s.uncheck()}),i.stopImmediatePropagation()})},t.prototype._parseTree=function(t){var i,n,s,r,o,a,l,d,u,c,p,h,f;for(i=e(t),n=e(document.createElement("span")).insertAfter(i),i.detach(),l=i.find("> li"),u=0,p=l.length;u<p;u++){if(a=l[u],f=e(a).find("> ul"),o=e(f).find("> li"),o.length>0||e(a).hasClass("folder"))for(s=e(document.createElement("button")).addClass("arrow"),e(a).addClass("folder has-children is-collapsed").prepend(s),c=0,h=f.length;c<h;c++)d=f[c],this._parseTree(d);else e(a).addClass("file");"list"===this.settings.style&&this.settings.multiselect===!0&&(r=e(document.createElement("input")).attr("type","checkbox"),e(a).prepend(r))}return i.find("li > a[data-type=folder]").closest("li").addClass("folder").removeClass("file"),i.insertBefore(n),n.remove()},t.prototype._nameSort=function(e,t){var i,n;return"function"==typeof this.settings.nodeTitle?(i=this.settings.nodeTitle(e),n=this.settings.nodeTitle(t)):(i=e[this.settings.nodeTitle],n=t[this.settings.nodeTitle]),i.toLowerCase()<n.toLowerCase()?-1:i.toLowerCase()>n.toLowerCase()?1:0},t}(),i=function(i,n){var s;return s=this,this.each(function(){var r,o;r=e(this),o=r.data("$.filetree"),o||r.data("$.filetree",o=new t(this,i)),"string"==typeof i&&"_"!==i.substr(0,1)&&(s=o[i].call(o,n))}),s},i.VERSION="{{version}}",s=e.fn.filetree,e.fn.filetree=i,e.fn.filetree.Constructor=t,e.fn.filetree.noConflict=function(){return e.fn.filetree=s,this}}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e){var t,i,n,s;n={before:function(){return!0},target:null,menuIdentifier:".dropdown-menu"},t=function(){function t(t,i){this.element=t,this.settings=e.extend({},n,i),i.target&&e(this.element).data("target",i.target),this.init()}return t.prototype.init=function(){e(this.element).on("contextmenu.menu.context",this.show.bind(this)),e("html, body").on("click.menu.context",this.hide.bind(this))},t.prototype.destroy=function(){e(this.element).off(".menu.context").data("$.contextmenu",null),e("html, body").off(".menu.context")},t.prototype.show=function(t){var i,n,s,r;if(!this.isDisabled()&&(this.hide(),t.preventDefault(),this.settings.before.call(this,t,e(t.currentTarget))))return n={relatedTarget:this,bubbles:!1},i=this.getMenu(),i.trigger(e.Event("show.menu.context",n)),s=this._getPosition(t,i),r=this,i.attr("style","").css(s).addClass("open").one("click.menu.context","li:not(.divider)",{context:t.target},function(e){var t;return t={item:e.target,context:e.data.context},i.trigger("click.item.context",[t]),r.hide.call(r),!1}).trigger(e.Event("shown.menu.context",n)),e("html").on("click.menu.context",i.selector,this.hide.bind(this)),!1},t.prototype.hide=function(){var t,i;if(t=this.getMenu(),t.hasClass("open"))return i={relatedTarget:this},t.trigger(e.Event("hide.menu.context",i)),t.removeClass("open").off("click.menu.context","li:not(.divider)").trigger(e.Event("hidden.menu.context",i)),e("html").off("click.menu.context",t.selector),!1},t.prototype.isDisabled=function(){return e(this.element).hasClass("disabled")||e(this.element).attr("disabled")},t.prototype.getMenu=function(){var t,i;return i=e(this.element).data("target"),i||(i=e(this.element).attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,"")),t=e(i),t.length||(t=e(this.element).find(i)),t},t.prototype._getPosition=function(t,i){var n,s,r,o,a,l,d,u,c,p,h,f;return l=(t.pointers?t.pointers[0]:t).clientX,d=(t.pointers?t.pointers[0]:t).clientY,n=e(window).width(),s=e(window).height(),a=i.find(this.settings.menuIdentifier).outerWidth(),r=i.find(this.settings.menuIdentifier).outerHeight(),h=e(window).scrollLeft(),f=e(window).scrollTop(),o={position:"fixed","z-index":9999},o.top=d+f,d+r>s&&(o.top-=r),o.left=l+h,l+a>n&&(o.left-=a),u=i.offsetParent().offset(),c=i.offsetParent().scrollLeft(),p=i.offsetParent().scrollTop(),o.left-=u.left+c,o.top-=u.top+p,o},t}(),i=function(i,n){return this.each(function(){var s,r,o;s=e(this),r=s.data("$.contextmenu"),r||s.data("$.contextmenu",r=new t(this,i)),"string"==typeof i&&"_"!==i.substr(0,1)&&(o=r[i].call(r,n))})},s=e.fn.contextmenu,e.fn.contextmenu=i,e.fn.contextmenu.Constructor=t,e.fn.contextmenu.noConflict=function(){return e.fn.contextmenu=s,this}});var _slicedToArray=function(){function e(e,t){var i=[],n=!0,s=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done)&&(i.push(o.value),!t||i.length!==t);n=!0);}catch(l){s=!0,r=l}finally{try{!n&&a["return"]&&a["return"]()}finally{if(s)throw r}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();!function(e){function t(e){return e.data("path").replace(e.data("name"),"").replace(/[\/\\]*$/g,"")}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],n=arguments[2],s=[];"*"!==t&&(n=!0);try{return e.forEach(function(e){if("file"===e.type&&(e.extension===t||"*"===t))return s.push(e);if("folder"===e.type&&e.children){if(n&&!e.children.length)return;var r=i(e.children,t,n);if(n&&!r.length)return;return e.children=r,s.push(e)}}),s}catch(r){console.warn("Event was cancelled")}}function n(){return document.cookie.split(";").reduce(function(e,t){var i=t.split("="),n=_slicedToArray(i,2),s=n[0],r=n[1];if("string"==typeof s&&"string"==typeof r)return e[s.trim()]=r.trim(),e},{})}var s=e._,r=e.$,o=e.Backbone,a=e.bootbox,l=e.moment,d=e.DashboardGlobals,u=e.Dashboard;d=d||{},u=u||{};var c="4",p={hideEmptyFolders:!1,disableFilters:!1,disableProperties:!1,footer:"",preserveOnHide:!1,postFetch:function(e){return e}},h={markedCut:!1,permissionlevel:0,type:"file"},f=[{value:"*",label:"All",icon:"asterisk"},{value:"efw",label:"Report",icon:"file-o"},{value:"efwsr",label:"Saved Report",icon:"save"},{value:"efwresult",label:"Result",icon:"cloud-download"}],m={menuItems:{divider:'<li class="divider "></li>',noOptions:'\n                <li class="disabled">\n                    <a href="#" data-action="hideMenu">\n                    &nbsp;No Options\n                    </a>\n                </li>',open:'\n                <li>\n                    <a href="#" data-action="open" data-type={{ext}}>\n                    &nbsp;Open\n                    </a>\n                </li>',edit:'\n                {% if (permissionLevel > 3)  { %}\n                    <li>\n                        <a href="#" data-action="edit" data-type={{ext}}>\n                        &nbsp;Edit\n                        </a>\n                    </li>\n                {% } %}',openInNewWindow:'\n                <li>\n                    <a href="#" data-action="new-window">\n                    &nbsp;Open In New Window\n                    </a>\n                </li>',newFolder:'\n                {% if (permissionLevel > 3)  { %}\n                    <li>\n                        <a href="#" data-action="new-folder">\n                        &nbsp;New Folder\n                        </a>\n                    </li>\n                {% } %}',properties:'\n                <li>\n                    <a href="#" data-action="properties">\n                    &nbsp;Properties\n                    </a>\n                </li>',"delete":'\n                {% if (permissionLevel > 3)  { %}\n                    <li>\n                        <a href="#" data-action="delete">\n                        &nbsp;Delete\n                        </a>\n                    </li>\n                {% } %}',cut:'\n                {% if (permissionLevel > 2)  { %}\n                    <li>\n                        <a href="#" data-action="cut">\n                        &nbsp;Cut\n                        </a>\n                    </li>\n                {% } %}',paste:'\n                {% if (permissionLevel > 2)  { %}\n                    <li {% if (!Boolean(markedCut)) { %} class="disabled" {% } %}>\n                        <a href="#"data-action="paste"> &nbsp;Paste </a>\n                    </li>\n                {% } %}',share:'\n                {% if (permissionLevel > 4)  { %}\n                    <li>\n                        <a href="#" data-action="share">\n                        &nbsp;Share\n                        </a>\n                    </li>\n                {% } %}',rename:'\n                {% if (permissionLevel > 2)  { %}\n                    <li>\n                        <a href="#" data-action="rename">\n                        &nbsp;Rename\n                        </a>\n                    </li>\n                {% } %}',"import":'\n                {% if (permissionLevel > 3)  { %}\n                    <li>\n                        <a href="#" id="importfile" data-action="import">\n                        &nbsp;Import\n                        </a>\n                    </li>\n                {% } %}',"export":'\n                {% if (permissionLevel > 2)  { %}\n                    <li>\n                        <a href="#" data-action="export">\n                        &nbsp;Export\n                        </a>\n                    </li>\n                 {% } %}'},filters:'\n            {% options.map(function(opt) { %}\n                <option value="{{opt.value}}" data-icon="{{opt.icon}}">\n                {{opt.label}}\n                </option>\n            {% }).join("") %}',properties:'\n            <div class="row">\n                <div class="col-sm-6 text-left">\n                    <p class="wrap-words hi-file-properties">\n                        <b>Name:</b> {{ name }}\n                    </p>\n                    <p class="hi-file-properties"> <b>Last Modified:</b> {{ lastmodified }} </p>\n                    <p class="hi-file-properties"> <b>Type:</b> {{ type }} </p>\n                </div>\n                <div class="col-sm-6 text-right">\n                    <br>\n                    <button class="btn btn-primary" id="show-all-properties">\n                    Show all properties\n                    </button>\n                </div>\n            </div>',dialog:'<div class="addScroll"><table class="table table-wrap" id="main"><thead><tr><th data-tip="Property">Property</th><th data-tip="Value">Value</th></tr></thead><tbody>{%_.each(_.omit(data,function(value, key) { return key.charAt(0) === "_" || !_.isString(value);} ),function(value, key) {if (key === "lastModified") {value = moment(parseInt(value, 10)).format();}if (key === "permissionLevel") {if (value === "0") { value = "No Access" }else if (value === "1") { value = "Execute Only" }else if (value === "2") { value = "Read only" }else if (value === "3") { value = "Read + Write" }else if (value === "4") { value = "Read + Write + Delete" }else if (value === "5") { value = "Read + Write + Delete + Share" }} key = key.charAt(0).toUpperCase() + key.slice(1); %}<tr><td data-tip="{{key}}"><b>{{key}}</b></td><td data-tip="{{value}}">{{value}}</td></tr>{%}); %}</tbody></table></div>',contextmenu:'\n            <div id="hdi-file-context-menu">\n                <ul class="dropdown-menu hi-ui-fontSize"> </ul>\n            </div>',editableForm:'\n            <div id="naming-form">\n                <div class="input-group has-error">\n                    <label class="sr-only" for="value"></label>\n                    <input type="text" class="form-control" id="editReportName" maxlength="60" data-validation-rules="required|filename|length(3)" data-validation-on="focusout" data-validation-msg="Please enter a valid name, minimum length 3." value="{{value}}">\n                    <span class="input-group-btn">\n                        <button class="btn btn-primary" id="saveReportName" data-validate="#editReportName" data-validate-on="click">\n                        <i class="fa fa-check"></i>\n                        </button>\n                    </span>\n                    <span class="input-group-btn">\n                        <button class="btn btn-danger contextMenuRename">\n                            <i class="fa fa-close"></i>\n                        </button>\n                    </span>\n                </div>\n            </div>',exportForm:'\n            <form method="POST" action="{{url}}">\n                <input name="action" value="{{action}}">\n                <textarea name="sourceArray">{{sourceArray}}</textarea>\n            </form>',importForm:'\n            <div>\n                <span class="btn btn-primary fileinput-button">\n                    <i class="glyphicon glyphicon-plus"></i>\n                    <span>Select files...</span> <!-- The file input field used as target for the file upload widget --> <input id="fileupload" type="file" name="file" accept=".zip"> </span> </div> <div> <br> <div class="progress hidden" id="fileupload-progress"> <div class="progress-bar" role="progressbar" id="fileupload-progress-bar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"> 0% </div> </div> </div>',formTemplate:'\n            <form id="hi-form-template" method="POST" action="{{url}}" target="parent_iframe" style="display:none"><input type="hidden" name="dir" value="{{dir}}"><input type="hidden" name="file" value="{{file}}"><input type="hidden" name="refresh" value="{{refresh}}"></form>'},g=o.View.extend({initialize:function(e){s.templateSettings.evaluate=/\{%(.*?)%\}/g,s.templateSettings.interpolate=/\{\{(.*?)\}\}/g,s.templateSettings.escape=/\{\{=(.*?)\}\}/g,this.options=r.extend(!0,{},p,e),this.id=this.options.id,this.openOptions={},this.filetree=null,this.render(),
this.selectedPath="/",this._originalTitle=""},className:"modal fade",attributes:{"data-keyboard":!1,"data-backdrop":"static"},events:{"file.click.filetree #hdi-file-explorer":"fileSelect","file.dblclick.filetree #hdi-file-explorer":"fileOpen","folder.click.filetree #hdi-file-explorer":"folderSelect","click #hdi-path-breadcrumb a":"navigateToPath","dblclick #hdi-file-navigator":"showPathForm","click #search-filetree":"showPathForm","click #close-file-browser":"hide","keydown #hdi-path-form":"formKeyActions","submit #hdi-path-form":"cancelEvent","click #refresh-tree":"refresh","click #homeNavigator":"refresh","click #close-path-field":"hidePathForm","change #filter":"filterFiles","click #hdi-select-folder":"triggerFolderSelect",scroll:"hideContextMenu","select2-open #filter":"hideContextMenuOnClick"},setOptions:function(e){this.__oldOptions=s.cloneDeep(this.options),this.options=r.extend(!0,{},this.options,e),this.fetchData()},resetOptions:function(){s.isObject(this.__oldOptions)&&(this.options=s.cloneDeep(this.__oldOptions)),this.__oldOptions=null,this.fetchData()},setFilter:function(e){return this.$("#filter").select2("val",e,!0),this},render:function(){var e=this,t=s.template(this.template)(this.options);if(this.$el.html(t).modal({show:!1,background:"static"}).on("hidden.bs.modal",function(){e.__resetOptions(),e.options.preserveOnHide||(e.selectedPath=null,e.clearFileBrowser(),e.makeFiletree(e.filesData))}),!this.options.disableFilters){var i=Array.isArray(this.options.filters)?f.filter(function(t){return e.options.filters.indexOf(t.value)>-1}):f.slice(0);i=s.template(m.filters)({options:i});var n=function(e){return'<i class="fa fa-'+r(e.element).data("icon")+'"></i> '+e.text};this.$("#filter").append(i).select2({formatResult:n,formatSelection:n,escapeMarkup:function(e){return e},minimumResultsForSearch:1/0})}var o=s.template(m.contextmenu);return r("body").append(o()),this.options.skipFetch||this.fetchData(),this.$("hdi-path-breadcrumb").on("selectstart",function(){return!1}),this},showProperties:function(e){if(this.options.disableProperties)return!1;var t=n(),i=e.data(),r=e.data("permissionLevel"),o=e.data("type"),a=Math.abs(t.serverTime),d=l(a).utc(),u=l(parseInt(i.lastModified,10));u=u.from(d),this.$("#hdi-file-properties").html(s.template(m.properties)({name:e.data("name"),type:o,lastmodified:u,permissionlevel:r})),this.$("#show-all-properties").off().on("click",this.showAllProperties.bind(this,e))},fileSelect:function(e){return this.filetree.select(e.target),this.showProperties(r(e.target)),this.selectedPath={actual:r(e.target).data("path"),logical:r(e.target).data("__path"),file:r(e.target).data("name")},this.selectedPath},folderSelect:function(e){if(r(e.target).closest("li").hasClass("disabled"))return!1;this.filetree.open(e.target),this.showProperties(r(e.target));var t=r(e.target).data("__path");t&&this.updateBreadCrumb(t.slice(1)),this.selectedPath={actual:r(e.target).data("path"),logical:r(e.target).data("__path")}},folderOpen:function(e){if(r(e.target).closest("li").hasClass("disabled"))return!1;this.filetree.open(e.target);var t=r(e.target).data("__path");t&&this.updateBreadCrumb(t.slice(1)),this.selectedPath={actual:r(e.target).data("path"),logical:r(e.target).data("__path")}},menuItemClick:function(e,t){if(e.preventDefault(),"LI"===e.target.tagName||"UL"===e.target.tagName)return!1;var i=r(t.item),n=r(t.context),s=i.data("action");return n.is("li")?n=n.find("> a"):(n.is("ul")||n.is("div.empty"))&&"new-folder"!==s&&(n=r(n).data("_parent")),n?void this.fileActions(s,n.data("type"),n.data("extension"),n):void this.fileActions(s,"folder",null,n)},updateBreadCrumb:function(e){var t=void 0,i=void 0,n=void 0,s=void 0,r=void 0;for(this.$("#hdi-path-field").val(e),e=e.split("/"),t='<li style="cursor:pointer; cursor: hand;"><i class="fa fa-home" id="homeNavigator"></i></li>',i=n=0,s=e.length;n<s;i=++n)r=e[i],t+=i===e.length-1?'<li class="active">'+r+"</li>":'<li><a href="#">'+r+"</a></li>";this.$("#hdi-path-breadcrumb").find("ol").html(t)},navigateToPath:function(e){e.preventDefault();var t=r(e.target).closest("li").prevUntil(":nth-child(1)").map(function(e,t){return r(t).find("> a").text()}).get();t.reverse().push(r(e.target).text()),t=t.join("/"),this.filetree.expandTo(t),this.updateBreadCrumb(t)},getCurrentPathFromCrumb:function(){var e=this.$("#hdi-path-breadcrumb").find("ol").find("li:not(:first-child)").map(function(e,t){return r(t).find("> a").text()}).get();return e=e.join("/")},cancelEvent:function(e){return e.preventDefault(),!1},associateArrays:function(e,t){if(!Array.isArray(e)||!Array.isArray(t))throw new TypeError("Expected arrays");for(var i={},n=0;n<e.length;n++)i[e[n]]=t[n];return i},pathSubmit:function(e){e.preventDefault();var t=this.openOptions.hideNonWritable?r.makeArray(this.$("#hdi-file-explorer").find("li.folder[data-writable] > a").map(function(){return r(this).data("__path").slice(1)})):r.makeArray(this.$("#hdi-file-explorer").find("a").map(function(){return r(this).data("__path").slice(1)})),i=this.openOptions.hideNonWritable?r.makeArray(this.$("#hdi-file-explorer").find("li.folder[data-writable] > a").map(function(){return r(this).data("path")})):r.makeArray(this.$("#hdi-file-explorer").find("a").map(function(){return r(this).data("path")})),n=this.$("#hdi-path-field").val().replace(/^\/|\/$/,""),s=n,o=this.associateArrays(t,i);r.each(o,function(e,t){return e===n&&(n=t),n});try{this.hidePathForm(e),this.updateBreadCrumb(s),this.filetree.expandGivenPath(n)}catch(a){var l=a.message.slice(16,-16);l=l.length>=1?'<b>Error:</b> The folder/file\n                            <div class="overflow" title="'+l+'">\n                                <b>'+l+"</b>\n                            </div> does not exists.":"<b>Error:</b> Please enter a folder/file name.",r.notify({message:l,icon:"fa fa-times"},{type:"danger"})}},showPathForm:function(e){e.preventDefault(),this.$("#hdi-path-form").removeClass("hidden"),this.$("#hdi-path-breadcrumb").addClass("hidden"),this.$("#hdi-path-field").focus()},hidePathForm:function(e){e.preventDefault(),this.$("#hdi-path-form").addClass("hidden"),this.$("#hdi-path-breadcrumb").removeClass("hidden"),this.$("#hdi-path-field").blur()},formKeyActions:function(e){switch(e.keyCode){case 27:this.hidePathForm(e);break;case 13:this.pathSubmit(e)}e.stopPropagation()},clearFileBrowser:function(e){return e&&"function"==typeof e.preventDefault&&e.preventDefault(),this.$("#filter").select2("val","*"),this.$("#hdi-file-properties").html(""),this.$("#hdi-path-form").find("input[type=text]").val(""),this.$("#hdi-path-breadcrumb").removeClass("hidden"),this.$("#hdi-path-form").addClass("hidden"),this.$("#hideSaveReportTemp").addClass("hidden"),this.$("#ScheduleReportTemp").addClass("hidden"),this.$("#hideDownloadReportTemp").addClass("hidden"),this.updateBreadCrumb("")},fetchData:function(){var e=this;this.clearFileBrowser(),this.selectedPath=null;var t=this.options.fetchDataUrl||d.solutionLoader+"?";return t+="&v="+(new Date).getTime(),r.get(t).done(function(t){var i=t,n=!Boolean(e.filesData);try{"string"==typeof t&&(i=JSON.parse(t))}catch(s){console.warn("Event was cancelled")}return e.filesData=e.options.postFetch(i.slice(0)),e.makeFiletree(e.filesData,n),window.ReactTooltip.rebuild(),e.__setOptions()})},refresh:function(){this.fetchData()},initializeContextMenu:function(){var e=this;return this.$("#hdi-file-explorer").contextmenu({target:"#hdi-file-context-menu",before:function(t){var i=r(t.target);if(!i.is("div.empty, ul, li, a"))return t.preventDefault(),!1;var n=this.getMenu(),s=void 0,o=void 0,a=void 0;i.is("li")?(i=i.find("> a"),a=i.data("type"),s=i.data("extension"),o=i.data("permissionLevel")):i.is("a")?(a=i.data("type"),s=i.data("extension"),o=i.data("permissionLevel")):i.is("ul, div.empty")&&(i=i.data("_parent"),a="column",o=Boolean(i)?i.data("permissionLevel"):c),o=parseInt(o,10);var l=e.markedCut,d=e.getMenuTemplate(r.extend({},h,Boolean(i)?i.data():{},{type:a,ext:s,permissionLevel:o,markedCut:l}));return n.find("> .dropdown-menu").empty().append(d)}})},hideContextMenu:function(){if(this.$("#hdi-file-explorer").data("$.contextmenu"))return this.$("#hdi-file-explorer").data("$.contextmenu").hide()},hideContextMenuOnClick:function(){r("#hdi-file-context-menu").hide()},makeFiletree:function(e,t){this.filetree&&this.filetree.destroy(),this.$("#hdi-file-explorer").data("$.contextmenu")&&this.$("#hdi-file-explorer").contextmenu("destroy");var n=i(e.slice(0),"*",this.options.hideEmptyFolders);this.$("#hdi-file-explorer").filetree({data:n,fileNodeName:"title",fileNodeTitle:"name",columnView:!0,nodeTitle:function(e){var t=void 0;return t="folder"===e.type?e.name:"efwresult"===e.extension?e.resultname:e.title},nodeFormatter:function(e){var t=e.find("> a"),i=e.find("a");if("folder"===t.data("type")?t.attr("data-tip",t.data("name")):"efwresult"===t.data("extension")?(t.attr("data-tip",t.data("resultname")),t.attr("title","")):t.attr("data-tip",t.data("title")),t.data("extension")&&e.attr("data-extension",t.data("extension")),"efwresult"===i.data("extension")){var n=i.data("__path");n&&i.data("__path",n.replace(i.text(),i.data("resultname"))),e.attr("title",i.text(i.data("resultname")))}t.data("schedulingreference")&&e.attr("data-schedule",t.data("schedulingreference")),t.data("resultfile")&&e.attr("data-ResultExt",t.data("resultfile").split(".").pop());var s=parseInt(t.data("permissionLevel"),10);return s>2&&e.attr("data-writable",!0),e}}),this.initializeContextMenu(),this.filetree=this.$("#hdi-file-explorer").data("$.filetree");var s=function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")};return this.$("#hdi-path-field").autocomplete({triggerSelectOnValidInput:!1,noCache:!0,lookupFilter:function(e,t){var i=s(t);return new RegExp(i,"ig").test(e.value)}}),r("#hdi-file-context-menu").off().on("click.item.context",this.menuItemClick.bind(this)),this.$("ul.list-group").off("scroll").on("scroll",this.hideContextMenu.bind(this)),t&&this.$el.trigger("loaded"),this},filterFiles:function(e){var t=r(e.target),n=t.val(),o=this.options.onlyFolders?s.cloneDeep(this.filesData):i(s.cloneDeep(this.filesData),n);this.makeFiletree(o),this.$("#hdi-file-properties").html(""),this.updateBreadCrumb(""),this.__setOptions(),window.ReactTooltip.rebuild()},show:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.filesData?(window.ReactTooltip.rebuild(),this.openOptions=t,this.__setOptions(),this.$el.modal("show")):void setTimeout(function(){return e.show()},200)},hide:function(){return this.__resetOptions(),this.options.preserveOnHide||(this.selectedPath=null,this.clearFileBrowser(),this.makeFiletree(this.filesData)),this.$el.modal("hide"),window.ReactTooltip.hide(),this},getSelected:function(){return this.selectedPath},triggerFolderSelect:function(){return this.hide()},__setOptions:function(){this.openOptions.footer&&(this.footerBackup=this.$("#hdi-file-footer").clone(!0),this.$("#hdi-file-footer").empty().append(this.openOptions.footer)),this.openOptions.hideFilters&&this.$("#hdi-file-filter").addClass("hidden"),this.openOptions.title&&this.$(".modal-title").html(this.openOptions.title),this.openOptions.hideProperties&&this.$("#hdi-file-properties").addClass("hidden"),this.openOptions.hideFiles&&this.$("li[data-extension]").addClass("hidden"),this.openOptions.hideNonWritable&&this.$("li.folder:not([data-writable])").addClass("hidden"),this.openOptions.hideContext&&this.$("#hdi-file-explorer").contextmenu("destroy");var e=this.openOptions.hideNonWritable?r.makeArray(this.$("#hdi-file-explorer").find("li.folder[data-writable] > a").map(function(){return r(this).data("__path").slice(1)})):r.makeArray(this.$("#hdi-file-explorer").find("a").map(function(){return r(this).data("__path").slice(1)}));this.$("#hdi-path-field").autocomplete("setOptions",{lookup:e})},__resetOptions:function(){return this.openOptions.footer&&(this.$("#hdi-file-footer").empty().append(this.footerBackup),this.footerBackup=null),this.$(".modal-title").html("File Browser"),this.openOptions.hideFilters&&this.$("#hdi-file-filter").removeClass("hidden"),this.openOptions.hideProperties&&this.$("#hdi-file-properties").removeClass("hidden"),this.openOptions.hideFiles&&this.$("li[data-extension]").removeClass("hidden"),this.openOptions.hideNonWritable&&this.$("li.folder.hidden").removeClass("hidden"),this.openOptions.hideContext&&this.initializeContextMenu(),this.openOptions={},this},loadInIFrame:function(e){var t=document.getElementById("dashboard-canvas"),i=t.contentWindow||window.document,n=t.contentDocument||i.document;return i.reportParameters=null,i.DashboardGlobals=d,n.open(),n.write(s.template(HDIUI.iframe)({data:e})),n.close(),r("body").trigger("report.opened.hdi"),this},efwLoader:function(e){var i=this;d.folderpath=e.data("path"),d.file=e.data("name"),d.extension=e.data("extension"),d.fileTitle=e.data("title"),d.currentReport=e.data(),""===this._originalTitle&&(this._originalTitle=document.title),document.title=d.fileTitle+" | "+this._originalTitle,r("#report-title").length>0&&r("#report-title").text(""+d.fileTitle),"file"===e.data("type")&&(d.folderpath=t(e)),r("#hi-report-new-window").length>0&&r("#hi-report-new-window").attr("href",""+(d.controllers.report+"?dir="+d.folderpath+"&file="+d.file+"&mode=open")),this.$el.modal("hide");var n=r.post(d.controllers[e.data("extension").toLowerCase()],{dir:d.folderpath,file:e.data("name")});n.identifier="serviceLoader",n.done(function(e){return i.loadInIFrame(e)})},getExtention:function(e){if(""===e){var t="file is empty.";r.notify({message:t,icon:"fa fa-times"},{type:"danger"})}var i=e.split(".");return i=i[1]},reLoader:function(e){var t=this,i=void 0;"efwsr"===d.extension?(i=r.post(d.controllers.efwsr,{dir:d.folderpath,file:d.file,refresh:!0,parameters:e}),i.identifier="serviceLoader",i.done(function(e){return t.loadInIFrame(e)})):(i=r.post(d.controllers.efw,{dir:d.folderpath,file:d.file,refresh:!0,parameters:e}),i.identifier="serviceLoader",i.done(function(e){return t.loadInIFrame(e+"<script>window.urlParameters={refresh:true}</script>")}))},reLoadCurrent:function(){var e=this,t=void 0;"efwsr"===d.extension?(t=r.post(d.controllers.efwsr,{dir:d.folderpath,file:d.file}),t.identifier="serviceLoader",t.done(function(t){return e.loadInIFrame(t)})):(t=r.post(d.controllers.efw,{dir:d.folderpath,file:d.file}),t.identifier="serviceLoader",t.done(function(t){return e.loadInIFrame(t)}))},efwresultLoader:function(e){var i=[d.downloadEnableSavedReport,"?dir=",t(e),"&filename=",e.data("name")].join("");r(".download-save-report-iframe").remove();var n=r(document.createElement("iframe")).addClass("download-save-report-iframe");n.attr({src:i,style:"visibility:hidden;display:none"}).appendTo(r("body")),n.load(function(){e=r(this),window.setTimeout(function(){return e.remove()},5e3)})},openAdhoc:function(e){var i=this;d.fileTitle=e.data("title"),d.extension=e.data("extension"),d.folderpath=e.data("path"),d.file=e.data("name"),d.currentReport=e.data(),""===this._originalTitle&&(this._originalTitle=document.title),document.title=d.fileTitle+" | "+this._originalTitle,"file"===e.data("type")&&(d.folderpath=t(e));var n=[d.openAdhoc,"?dir=",d.folderpath,"&file=",e.data("name")].join("");return r("#dashboard-canvas").attr("src",n),i.$el.modal("hide"),r("body").trigger("report.opened.hdi")},openAdhocInNewWindow:function(e){var i=[d.openAdhoc,"?dir=",t(e),"&file=",e.data("name"),"&mode=","open"].join("");return window.open(i,"_blank","","")},fileOpen:function(e){var t=void 0,i=void 0,n=void 0,s=void 0,o=void 0;return window.ReactTooltip.hide(),i=r(e.target),n=i.data("extension"),s=parseInt(i.data("permissionLevel"),10),delete d.efwddir,o=this.getMenuTemplate(r.extend({},h,i.data(),{ext:n,permissionLevel:s})),t=r(o).find("a").eq(0).attr("data-action"),this.fileActions(t,"file",n,i),e.preventDefault(),!1},fileActions:function(e,t,i,n){switch(e){case"open":if("file"===t)return"efwresult"===i?this.efwresultLoader(n):this.efwLoader(n);break;case"new-window":if("file"===t&&("efw"===i||"efwresult"===i||"efwsr"===i))return this.openInNewWindow(n);break;case"share":return this.showShare(n);case"properties":return this.showAllProperties(n);case"rename":return this.showRenameForm(n);case"delete":return this.deleteItem(n);case"new-folder":return this.newFolder(n);case"export":return this.exportRequest(n);case"import":return this.showImportForm(n);case"cut":return this.markCut(n);case"paste":return this.paste(n);default:s.isObject(this.options.customActions)&&"function"==typeof this.options.customActions[e]&&this.options.customActions[e](n)}},openInNewWindow:function(e){var i=void 0;return i="efwsr"===e.data("extension")?d.openEfw+"?dir="+t(e)+"&file="+e.data("name")+"&mode=open":d.openEfw+"?dir="+t(e)+"&file="+e.data("name"),window.open(i,"_blank","","")},showRenameForm:function(e){var t=void 0;return this.hideRenameForm(),e.addClass("hidden"),"folder"===e.data("type")?t=e.data("name"):"efwresult"===e.data("extension")?(t=e.data("title"),t=e.data("resultname")):t=e.data("title"),e.closest("li").append(s.template(m.editableForm)({value:t})),this.setupNamingform(e,"sendRenameRequest","hideRenameForm")},sendRenameRequest:function(e,t){var i=this,n=e.data("path"),s=this.$("#naming-form").find("input").val();return"function"==typeof t&&window.setTimeout(t.bind(this),10),r.post(d.fsop,{sourceArray:JSON.stringify([[n,s]]),action:"rename"}).done(function(e){e.status&&i.fetchData()})},hideRenameForm:function(){this.$("#naming-form").find("input").blur().end().siblings("a.hidden").removeClass("hidden").end().off().remove()},showAllProperties:function(e){var t=s.template(m.dialog,{variable:"data"})(e.data()),i=a.alert({title:"File Properties",message:t});window.ReactTooltip.rebuild(),i.on("hide.bs.modal",function(){r("body").tooltip("destroy")})},deleteItem:function(e){var t='Are you sure you want to delete <b class="wrap-words text-wrapper">'+e.text()+"</b> ?",i="Deleting ",n=this;return"efwsr"===e.data("extension")&&e.data("schedulingreference")?(t+=" Along with this, scheduling will also be deleted.",i+="Saved file"):i+="file",a.dialog({message:t,title:i,buttons:{main:{label:"Ok",className:"btn-primary clearProps",callback:function(){e.data("path").replace(e.data("name"),"").replace(/[\/\\]*$/g,"");r.post(d.fsop,{sourceArray:JSON.stringify([e.data("path")]),action:"delete"}).done(function(e){e.status&&n.fetchData()})}},danger:{label:"Cancel",className:"btn-danger"}}})},newFolder:function(e){var t=r(document.createElement("li")).addClass("folder list-group-item");t.append(s.template(m.editableForm)({value:"New Folder"})),e.append(t),this.setupNamingform(e,"sendNewFolderRequest","hideNewFolder")},hideNewFolder:function(){return this.$("#naming-form").find("input").blur(),this.$("#naming-form").off().remove()},sendNewFolderRequest:function(e,t){var i=this,n=this.$("#naming-form").find("input").val(),s=e.data("_parent")?e.data("_parent").data("path"):"";"function"==typeof t&&window.setTimeout(t.bind(this),10),r.post(d.fsop,{sourceArray:JSON.stringify([s]),action:"newFolder",folderName:n}).done(function(e){e.status&&i.fetchData()})},exportRequest:function(e){var t=r(s.template(m.exportForm)({url:d.fsop,action:"export",sourceArray:JSON.stringify([e.data("path")])}));return t.appendTo("body").submit().remove()},showImportForm:function(e){var t=void 0,i=void 0;i=this,a.dialog({title:"File Upload",message:m.importForm}),t=e?e.data("path"):"",r("#fileupload").data("blueimp-fileupload")&&r("#fileupload").fileupload("destroy"),r("#fileupload").fileupload({url:d.importFile,autoUpload:!0,always:function(){a.hideAll(),r("#fileupload-progress-bar").css("width","0%").text("0%").attr("aria-valuenow",0)},add:function(e,t){r("#fileupload-progress").removeClass("hidden"),t.submit()},progressall:function(e,t){var i=parseInt(t.loaded/t.total*100,10);r("#fileupload-progress-bar").css("width",i+"%").text(i+"%").attr("aria-valuenow",i)},formData:function(){return[{name:"destination",value:t}]},done:function(e,t){return 1===t.result.status&&i.fetchData(),a.hideAll()}})},markCut:function(e){this.markedCut=e,this.sourcePath=e.data("path"),e.closest("li").addClass("disabled"),this.filetree.close(e)},paste:function(e){var t=this;if(!Boolean(this.markedCut))return!1;var i=this.sourcePath,n=e&&e.data("path")?e.data("path"):"";r.post(d.fsop,{destination:n,sourceArray:JSON.stringify([i]),action:"move"}).always(function(){return t.fetchData()}),this.markedCut=null},setupNamingform:function(e,t,i){var n=this;return this.$("#naming-form").find("input").focus(),this.$("#naming-form").off().on("submit",function(e){return e.preventDefault(),!1}).on("click","#saveReportName",function(s){return s.preventDefault(),!!n.$("#editReportName").validate()&&(n[t](e,n[i]),!1)}).on("click","button.btn-danger",function(e){return n[i](),e.preventDefault(),!1})},showShare:function(e){"undefined"==typeof this.ShareForm&&(this.ShareForm=new g.ShareForm({id:"hdi-ShareForm"+(new Date).getTime()}),this.$el.append(this.ShareForm)),this.ShareForm.show(e)},getMenuTemplate:function(e){e.permissionLevel||(e.permissionLevel=0);var t=r.extend(!0,{},this.menuTemplate,this.options.menuTemplate),i=void 0;return i="file"===e.type?t.files[e.ext].call(this)+t.files.common.call(this):t[e.type].call(this),i=s.template(i)(e).trim(),0===i.length&&(i=m.menuItems.noOptions),i},menuTemplate:{column:function(){return[m.menuItems.newFolder,'{% if (permissionLevel > 2)  { %}\n                        <li class="divider"></li>\n                    {% } %}',m.menuItems["import"],m.menuItems.paste].join("")},folder:function(){return[m.menuItems.rename,m.menuItems["delete"],'{% if (permissionLevel > 2)  { %}\n                        <li class="divider"></li>\n                    {% } %}',m.menuItems["import"],m.menuItems.paste,'{% if (permissionLevel > 4)  { %}\n                        <li class="divider"></li>\n                    {% } %}',m.menuItems.share,m.menuItems.properties].join("")},files:{efw:function(){return[m.menuItems.open,m.menuItems.openInNewWindow,m.menuItems.divider,m.menuItems["delete"],m.menuItems.rename,'{% if (permissionLevel > 4)  { %}\n                            <li class="divider"></li>\n                        {% } %}',m.menuItems.share].join("")},efwsr:function(){return[m.menuItems.open,m.menuItems.openInNewWindow,'{% if (permissionLevel > 2)  { %}\n                            <li class="divider"></li>\n                        {% } %}',m.menuItems.rename,m.menuItems["delete"],'{% if (permissionLevel > 2)  { %}\n                            <li class="divider"></li>\n                        {% } %}',m.menuItems["export"],m.menuItems.cut,'{% if (permissionLevel > 2)  { %}\n                            <li class="divider"></li>\n                        {% } %}',m.menuItems.paste,m.menuItems.share,'{% if (permissionLevel === 2)  { %}\n                            <li class="divider"></li>\n                        {% } %}'].join("")},efwresult:function(){return[m.menuItems.open,'{% if (permissionLevel > 2)  { %}\n                            <li class="divider"></li>\n                        {% } %}',m.menuItems.rename,m.menuItems["delete"],'{% if (permissionLevel > 2)  { %}\n                            <li class="divider"></li>\n                        {% } %}',m.menuItems.cut,m.menuItems.paste,'{% if (permissionLevel > 4)  { %}\n                            <li class="divider"></li>\n                        {% } %}',m.menuItems.share].join("")},common:function(){return['{% if (permissionLevel > 2)  { %}\n                            <li class="divider"></li>\n                        {% } %}',m.menuItems.properties].join("")}}},template:'<div class="modal-dialog modal-fluid hi-hideBrowserContextMenu"><div class="modal-content"><div class="modal-header"><div class="pull-right"><button type="button" class="btn btn-primary" id="refresh-tree"><span class="fa fa-refresh"></span></button><button type="button" class="btn btn-danger" id="close-file-browser"><span aria-hidden="true" class="fa fa-close"></span><span class="sr-only">Close</span></button></div><h4 class="modal-title">File Browser</h4></div><div class="modal-body">{% if (!disableFilters) { %}<div class="form-horizontal" id="hdi-file-filter"><div class="form-group"><label for="filter" class="col-sm-9 control-label">Filter by type:</label><div class="col-sm-3"><select name="" id="filter" class="form-control"> </select></div></div></div>{% } %}<div id="hdi-file-navigator"><div class="clearfix" id="hdi-path-breadcrumb"><div class="col col-xs-11"><ol class="breadcrumb no-selection" unselectable="on"><li class="home" style="cursor:pointer; cursor: hand;"><span class="fa fa-home" id="homeNavigator">&thinsp;</span></li></ol></div><div class="col col-xs-1"><button type="button" class="btn btn-primary btn-block" id="search-filetree"><i class="fa fa-search">&thinsp;</i></button></div></div><form id="hdi-path-form" class="hidden"><div class="form-group"><div class="input-group"><input type="text" class="form-control" id="hdi-path-field"><span class="input-group-btn"><button class="btn btn-danger" id="close-path-field"><i class="fa fa-close"></i></button></span></div></div></form></div><div id="hdi-file-explorer" class="panel-group"> </div>{% if (!disableProperties ) { %}<div id="hdi-file-properties" class="panel-group"> </div>{% } %}<div id="hdi-file-footer">{{footer}}</div></div></div></div>'});g.templates=m,e.HDIFileBrowser=g}(window),function(e){var t=e._,i=e.Backbone,n=e.$,s=i.Model.extend({defaults:{currentUsersData:[],initialUsersData:[],currentRolesData:[],initialRolesData:[]}}),r=i.View.extend({model:r,initialize:function(e){t.templateSettings.evaluate=/\{%(.*?)%\}/g,t.templateSettings.interpolate=/\{\{(.*?)\}\}/g,t.templateSettings.escape=/\{\{=(.*?)\}\}/g,this.model=e.model||new s,this.listenTo(this.model,"change:initialUsersData",this.renderUsers.bind(this)),this.listenTo(this.model,"change:initialRolesData",this.renderRoles.bind(this)),this.render(),this.$el.tooltip({title:function(){return n(this).attr("data-tooltip")},container:this.$el,selector:"[data-tooltip]",html:!0,placement:"top"})},className:"modal fade",attributes:{"data-keyboard":!1,"data-backdrop":"static"},events:{"click #cancel-btn":"hide","click #share-btn":"share"},render:function(){var e=this,i=t.template(this.template);this.$el.html(i()).modal({show:!1}).on("hidden.bs.modal",function(){e.$("#user-data").find("input").prop("checked",!1),e.$("#role-data").find("input").prop("checked",!1),e.$el.tooltip("destroy")})},show:function(e){var t=this;this.orgLogin=window.admin,this.currentFolder=e,this.model.get("initialUsersData").length||this.model.get("initialRolesData").length?this.getCurrentFileData(e):this.getInitialData().done(function(){return t.getCurrentFileData(e)})},getCurrentFileData:function(e){var i=this,s={type:e.data("type")};"folder"===e.data("type")?s.dir=e.data("path"):"dataSource"===e.data("type")?(s.type="dataSource",s.id=e.data("id"),s.dir=e.data("dir"),s.classifier=e.data("classifier"),e.data("dataSourceProvider")&&(s.dataSourceProvider=e.data("dataSourceProvider"))):(s.dir=e.data("path").replace(e.data("name"),"").replace(/[\/\\]*$/g,""),s.file=e.data("name")),n.post(window.DashboardGlobals.services,{type:"core",serviceType:"share",service:"retrieveSharedInfo",formData:JSON.stringify(s)}).done(function(e){if("string"==typeof e&&(e=JSON.parse(e)),e.status&&(i.model.get("initialUsersData").length||i.model.get("initialRolesData").length)){var n=i.model.get("initialUsersData").map(function(e){return e.id}),s=i.model.get("initialRolesData").map(function(e){return e.id}),r=t.filter(e.response.user,function(e){return n.indexOf(parseInt(e.id,10))>-1}),o=t.filter(e.response.role,function(e){return s.indexOf(parseInt(e.id,10))>-1});i.model.set("currentUserData",r),i.model.set("currentRoleData",o);var a=i.$("#user-data");a.find("input:checked").prop("checked",!1),t.each(r,function(e){a.find("input[value="+e.id+"]").prop("checked",!0)});var l=i.$("#role-data");l.find("input:checked").prop("checked",!1),t.each(o,function(e){return l.find("input[value="+e.id+"]").prop("checked",!0)}),i.$el.modal("show")}})},hide:function(){this.$el.modal("hide")},getInitialData:function(){var e=this,t={provide:{provideUsers:"true",provideRoles:"true"}};return""===window.admin&&(t.provide.id="all"),n.post(window.DashboardGlobals.services,{type:"core",serviceType:"share",service:"fetchInfo",formData:JSON.stringify(t)}).done(function(t){"string"==typeof t&&(t=JSON.parse(t)),t.response.allUsers.total>1&&e.model.set("initialUsersData",t.response.allUsers.users),e.model.set("initialRolesData",t.response.allRoles.roles)})},share:function(){var e=this,i=this.currentFolder,s=this.model.get("currentUserData"),r=this.model.get("currentRoleData"),o=this.$("#user-data").find("input:checked").map(function(e,t){return{id:n(t).val(),permission:2}}).get(),a=this.$("#role-data").find("input:checked").map(function(e,t){return{id:n(t).val(),permission:2}}).get(),l=void 0,d=void 0,u=void 0,c=void 0;s?(l=t.filter(o,function(e){var i=e.id;return!t.find(s,{id:i})}),d=t.filter(s,function(e){var i=e.id;return!t.find(o,{id:i})})):l=o,r?(u=t.filter(a,function(e){var i=e.id;return!t.find(r,{id:i})}),c=t.filter(r,function(e){var i=e.id;return!t.find(a,{id:i})})):u=a;var p={type:i.data("type")};"folder"===i.data("type")?p.dir=i.data("path"):"dataSource"===i.data("type")?(p.type="dataSource",p.id=i.data("id"),p.dir=i.data("dir"),p.classifier=i.data("classifier"),i.data("dataSourceProvider")&&(p.dataSourceProvider=i.data("dataSourceProvider"))):(p.dir=i.data("path").replace(i.data("name"),"").replace(/[\/\\]*$/g,""),p.file=i.data("name")),d&&d.length>0&&(p.revoke?p.revoke.user=d:(p.revoke={},p.revoke.user=d)),c&&c.length>0&&(p.revoke?p.revoke.role=c:(p.revoke={},p.revoke.role=c)),l.length>0&&(p.share?p.share.user=l:(p.share={},p.share.user=l)),u.length>0&&(p.share?p.share.role=u:(p.share={},p.share.role=u)),n.post(window.DashboardGlobals.services,{type:"core",serviceType:"share",service:"update",formData:JSON.stringify(p)}).done(function(t){"string"==typeof t&&(t=JSON.parse(t)),t.status&&e.hide()})},renderUsers:function(){var e=t.template(this.usersTemplate)({data:this.model.get("initialUsersData")});this.$("#user-data").empty().append(e)},renderRoles:function(){var e=t.template(this.roleTemplate)({data:this.model.get("initialRolesData")});this.$("#role-data").empty().append(e)},usersTemplate:'\n            <table class="table tableLayout">\n                <thead>\n                    <tr>\n                        <th></th>\n                        <th data-tooltip="User">User</th>\n                       \n                    </tr>\n                </thead>\n                <tbody>\n                    {% _.each(data, function(user, i) { %}\n                    <tr>\n                        <td><input type="checkbox" value="{{user.id}}"></td>\n                        <td class="overflow" data-tooltip="{{user.name}}">{{user.name}}</td>\n                    </tr>\n                    {% }); %}\n                </tbody>\n            </table>\n      ',roleTemplate:'\n            <table class="table tableLayout">\n                <thead>\n                    <tr>\n                        <th></th>\n                        <th data-tooltip="Role">Role</th>\n                        \n                    </tr>\n                </thead>\n                <tbody>\n                    {% _.each(data, function(role, i) { %}\n                    <tr>\n                        <td><input type="checkbox" value="{{role.id}}"></td>\n                        <td class="overflow" data-tooltip="{{role.name}}">{{role.name}}</td>\n                    </tr>\n                    {% }); %}\n                </tbody>\n            </table>\n      ',template:'\n            <div class="modal-dialog">\n                <div class="modal-content">\n                    <div class="modal-header">\n                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n                        <h4 class="modal-title toggleHeading"><b>Share Options</b></h4>\n                    </div>\n                    <div class="modal-body">\n                    <ul class="nav nav-tabs  hi-tab-highlight nav-justified">\n                        <li role="navigation" class="active">\n                            <a href="#user" aria-controls="user" role="tab" data-toggle="tab">Users</a>\n                        </li>\n                        <li role="navigation">\n                            <a href="#role" aria-controls="role" role="tab" data-toggle="tab">Roles</a>\n                        </li>\n                    </ul>\n                    <div class="tab-content">\n                        <div class="tab-pane active addScroll" id="user" data-validation-group="users" data-validation-rules="required" data-validation-msg="Please select at least one user or role">\n                            <form id="user-data" ></form>\n                        </div>\n                        <div class="tab-pane addScroll" id="role" data-validation-group="users" data-validation-rules="required" data-validation-msg="Please select at least one user or role">\n                            <form id="role-data"></form>\n                        </div>\n                    <div>\n                </div>\n                <div class="modal-footer">\n                    <div class="text-center">\n                        <button class="btn btn-primary" id="share-btn">\n                            <i class="fa fa-share-alt"></i>&nbsp;&nbsp;Share\n                        </button>&nbsp;&nbsp;\n                        <button class="btn btn-danger" id="cancel-btn">\n                            <i class="fa fa-times"></i>&nbsp;&nbsp;Cancel\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n      '
});e.HDIFileBrowser.ShareForm=r}(window);
//# sourceMappingURL=file-browser.js.map
